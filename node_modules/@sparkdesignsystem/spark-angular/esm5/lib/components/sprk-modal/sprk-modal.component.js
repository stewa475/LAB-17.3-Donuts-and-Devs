import { __decorate, __metadata } from "tslib";
import { Component, EventEmitter, HostListener, Input, Output } from '@angular/core';
import * as _ from 'lodash';
var SprkModalComponent = /** @class */ (function () {
    /**
     * @ignore
     */
    function SprkModalComponent() {
        /**
         * The value supplied will be
         * rendered as the text for the confirm button.
         */
        this.confirmText = 'Confirm';
        /**
         * The value supplied will be rendered
         * as the text for the cancel button.
         */
        this.cancelText = 'Cancel';
        /**
         * If `true`, the Modal will be shown.
         * If `false`, the modal will not be shown.
         */
        this.isVisible = false;
        /**
         * When the Modal is closed the hide event is
         * emitted and a callback function can
         * be triggered if supplied.
         */
        this.hide = new EventEmitter();
        /**
         * Available when the Modal type is `choice`.
         * The Modal will emit a confirm click event
         * when the confirmation button is clicked.
         * A callback function can be triggered if
         * supplied.
         */
        this.confirmClick = new EventEmitter();
        /**
         * Available when the Modal type is `choice`.
         * The Modal will emit a cancel click event
         * when the cancel link is clicked.
         * A callback function can be triggered if supplied.
         */
        this.cancelClick = new EventEmitter();
        /**
         * @ignore
         */
        this.componentID = _.uniqueId();
        /**
         * @ignore
         */
        this.heading_id = "modalHeading__" + this.componentID;
        /**
         * @ignore
         */
        this.content_id = "modalContent__" + this.componentID;
    }
    /**
     * @ignore
     */
    SprkModalComponent.prototype.handleKeyboardEvent = function (event) {
        if (this.isVisible && event.key === 'Escape') {
            this.closeModal(event);
        }
    };
    /**
     * @ignore
     */
    SprkModalComponent.prototype.closeModal = function (event) {
        if (this.modalType !== 'wait') {
            event.preventDefault();
            this.hide.emit(event);
        }
    };
    /**
     * Emits an event when the confirmation
     * button is clicked.
     */
    SprkModalComponent.prototype.emitConfirmClick = function (event) {
        this.confirmClick.emit(event);
    };
    /**
     * Emits an event when the cancel
     * link is clicked.
     */
    SprkModalComponent.prototype.emitCancelClick = function (event) {
        event.preventDefault();
        this.cancelClick.emit(event);
        this.closeModal(event);
    };
    __decorate([
        Input(),
        __metadata("design:type", String)
    ], SprkModalComponent.prototype, "title", void 0);
    __decorate([
        Input(),
        __metadata("design:type", String)
    ], SprkModalComponent.prototype, "modalType", void 0);
    __decorate([
        Input(),
        __metadata("design:type", Object)
    ], SprkModalComponent.prototype, "confirmText", void 0);
    __decorate([
        Input(),
        __metadata("design:type", Object)
    ], SprkModalComponent.prototype, "cancelText", void 0);
    __decorate([
        Input(),
        __metadata("design:type", String)
    ], SprkModalComponent.prototype, "confirmAnalyticsString", void 0);
    __decorate([
        Input(),
        __metadata("design:type", String)
    ], SprkModalComponent.prototype, "cancelAnalyticsString", void 0);
    __decorate([
        Input(),
        __metadata("design:type", String)
    ], SprkModalComponent.prototype, "idString", void 0);
    __decorate([
        Input(),
        __metadata("design:type", Object)
    ], SprkModalComponent.prototype, "isVisible", void 0);
    __decorate([
        Output(),
        __metadata("design:type", Object)
    ], SprkModalComponent.prototype, "hide", void 0);
    __decorate([
        Output(),
        __metadata("design:type", Object)
    ], SprkModalComponent.prototype, "confirmClick", void 0);
    __decorate([
        Output(),
        __metadata("design:type", Object)
    ], SprkModalComponent.prototype, "cancelClick", void 0);
    __decorate([
        HostListener('document:keydown', ['$event']),
        __metadata("design:type", Function),
        __metadata("design:paramtypes", [KeyboardEvent]),
        __metadata("design:returntype", void 0)
    ], SprkModalComponent.prototype, "handleKeyboardEvent", null);
    SprkModalComponent = __decorate([
        Component({
            selector: 'sprk-modal',
            template: "\n    <div\n      *ngIf=\"isVisible\"\n      [ngClass]=\"{\n        'sprk-c-Modal': true,\n        'sprk-c-Modal--wait': modalType === 'wait'\n      }\"\n      role=\"dialog\"\n      tabindex=\"1\"\n      [attr.aria-labelledby]=\"heading_id\"\n      aria-modal=\"true\"\n      [attr.aria-describedby]=\"content_id\"\n      [attr.data-id]=\"idString\"\n    >\n      <div class=\"sprk-o-Stack sprk-o-Stack--large\">\n        <header class=\"sprk-o-Stack__item sprk-c-Modal__header\">\n          <h2\n            class=\"sprk-c-Modal__heading sprk-b-TypeDisplayFour\"\n            [id]=\"heading_id\"\n          >\n            {{ title }}\n          </h2>\n\n          <button\n            *ngIf=\"modalType != 'wait'\"\n            class=\"sprk-c-Modal__icon\"\n            type=\"button\"\n            aria-label=\"Close Modal\"\n            (click)=\"closeModal($event)\"\n          >\n            <sprk-icon\n              iconType=\"close\"\n              additionalClasses=\"sprk-c-Icon--stroke-current-color\"\n            ></sprk-icon>\n          </button>\n        </header>\n\n        <div\n          class=\"sprk-o-Stack__item sprk-c-Modal__body sprk-o-Stack sprk-o-Stack--medium\"\n        >\n          <div\n            *ngIf=\"modalType == 'wait'\"\n            class=\"sprk-o-Stack__item sprk-c-Spinner sprk-c-Spinner--circle sprk-c-Spinner--large sprk-c-Spinner--dark\"\n          ></div>\n          <ng-content></ng-content>\n        </div>\n\n        <footer\n          *ngIf=\"modalType === 'choice'\"\n          class=\"sprk-o-Stack__item sprk-c-Modal__footer\"\n        >\n          <button\n            class=\"sprk-c-Button sprk-u-mrm\"\n            [attr.data-analytics]=\"confirmAnalyticsString\"\n            (click)=\"emitConfirmClick($event)\"\n          >\n            {{ confirmText }}\n          </button>\n\n          <button\n            class=\"sprk-c-Button sprk-c-Button--tertiary\"\n            [attr.data-analytics]=\"cancelAnalyticsString\"\n            (click)=\"emitCancelClick($event)\"\n          >\n            {{ cancelText }}\n          </button>\n        </footer>\n      </div>\n    </div>\n\n    <div\n      *ngIf=\"isVisible\"\n      class=\"sprk-c-ModalMask\"\n      tabindex=\"-1\"\n      (click)=\"closeModal($event)\"\n    ></div>\n  "
        }),
        __metadata("design:paramtypes", [])
    ], SprkModalComponent);
    return SprkModalComponent;
}());
export { SprkModalComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3Byay1tb2RhbC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9Ac3BhcmtkZXNpZ25zeXN0ZW0vc3BhcmstYW5ndWxhci8iLCJzb3VyY2VzIjpbImxpYi9jb21wb25lbnRzL3NwcmstbW9kYWwvc3Byay1tb2RhbC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFDTCxTQUFTLEVBQ1QsWUFBWSxFQUNaLFlBQVksRUFDWixLQUFLLEVBQ0wsTUFBTSxFQUNQLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sS0FBSyxDQUFDLE1BQU0sUUFBUSxDQUFDO0FBa0Y1QjtJQW9HRTs7T0FFRztJQUNIO1FBOUZBOzs7V0FHRztRQUVILGdCQUFXLEdBQUcsU0FBUyxDQUFDO1FBQ3hCOzs7V0FHRztRQUVILGVBQVUsR0FBRyxRQUFRLENBQUM7UUEyQnRCOzs7V0FHRztRQUVILGNBQVMsR0FBRyxLQUFLLENBQUM7UUFDbEI7Ozs7V0FJRztRQUVILFNBQUksR0FBRyxJQUFJLFlBQVksRUFBTyxDQUFDO1FBQy9COzs7Ozs7V0FNRztRQUVILGlCQUFZLEdBQUcsSUFBSSxZQUFZLEVBQU8sQ0FBQztRQUN2Qzs7Ozs7V0FLRztRQUVILGdCQUFXLEdBQUcsSUFBSSxZQUFZLEVBQU8sQ0FBQztRQUN0Qzs7V0FFRztRQUNILGdCQUFXLEdBQUcsQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFDO1FBQzNCOztXQUVHO1FBQ0gsZUFBVSxHQUFHLG1CQUFpQixJQUFJLENBQUMsV0FBYSxDQUFDO1FBQ2pEOztXQUVHO1FBQ0gsZUFBVSxHQUFHLG1CQUFpQixJQUFJLENBQUMsV0FBYSxDQUFDO0lBZWxDLENBQUM7SUFiaEI7O09BRUc7SUFFSCxnREFBbUIsR0FBbkIsVUFBb0IsS0FBb0I7UUFDdEMsSUFBSSxJQUFJLENBQUMsU0FBUyxJQUFJLEtBQUssQ0FBQyxHQUFHLEtBQUssUUFBUSxFQUFFO1lBQzVDLElBQUksQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLENBQUM7U0FDeEI7SUFDSCxDQUFDO0lBT0Q7O09BRUc7SUFDSCx1Q0FBVSxHQUFWLFVBQVcsS0FBSztRQUNkLElBQUksSUFBSSxDQUFDLFNBQVMsS0FBSyxNQUFNLEVBQUU7WUFDN0IsS0FBSyxDQUFDLGNBQWMsRUFBRSxDQUFDO1lBQ3ZCLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1NBQ3ZCO0lBQ0gsQ0FBQztJQUVEOzs7T0FHRztJQUNILDZDQUFnQixHQUFoQixVQUFpQixLQUFLO1FBQ3BCLElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ2hDLENBQUM7SUFFRDs7O09BR0c7SUFDSCw0Q0FBZSxHQUFmLFVBQWdCLEtBQUs7UUFDbkIsS0FBSyxDQUFDLGNBQWMsRUFBRSxDQUFDO1FBQ3ZCLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQzdCLElBQUksQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDekIsQ0FBQztJQWpJRDtRQURDLEtBQUssRUFBRTs7cURBQ007SUFNZDtRQURDLEtBQUssRUFBRTs7eURBQ1U7SUFNbEI7UUFEQyxLQUFLLEVBQUU7OzJEQUNnQjtJQU14QjtRQURDLEtBQUssRUFBRTs7MERBQ2M7SUFRdEI7UUFEQyxLQUFLLEVBQUU7O3NFQUN1QjtJQVEvQjtRQURDLEtBQUssRUFBRTs7cUVBQ3NCO0lBVTlCO1FBREMsS0FBSyxFQUFFOzt3REFDUztJQU1qQjtRQURDLEtBQUssRUFBRTs7eURBQ1U7SUFPbEI7UUFEQyxNQUFNLEVBQUU7O29EQUNzQjtJQVMvQjtRQURDLE1BQU0sRUFBRTs7NERBQzhCO0lBUXZDO1FBREMsTUFBTSxFQUFFOzsyREFDNkI7SUFrQnRDO1FBREMsWUFBWSxDQUFDLGtCQUFrQixFQUFFLENBQUMsUUFBUSxDQUFDLENBQUM7O3lDQUNsQixhQUFhOztpRUFJdkM7SUFsR1Usa0JBQWtCO1FBaEY5QixTQUFTLENBQUM7WUFDVCxRQUFRLEVBQUUsWUFBWTtZQUN0QixRQUFRLEVBQUUsK3VFQTRFVDtTQUNGLENBQUM7O09BQ1csa0JBQWtCLENBb0k5QjtJQUFELHlCQUFDO0NBQUEsQUFwSUQsSUFvSUM7U0FwSVksa0JBQWtCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgQ29tcG9uZW50LFxuICBFdmVudEVtaXR0ZXIsXG4gIEhvc3RMaXN0ZW5lcixcbiAgSW5wdXQsXG4gIE91dHB1dFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCAqIGFzIF8gZnJvbSAnbG9kYXNoJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnc3Byay1tb2RhbCcsXG4gIHRlbXBsYXRlOiBgXG4gICAgPGRpdlxuICAgICAgKm5nSWY9XCJpc1Zpc2libGVcIlxuICAgICAgW25nQ2xhc3NdPVwie1xuICAgICAgICAnc3Byay1jLU1vZGFsJzogdHJ1ZSxcbiAgICAgICAgJ3NwcmstYy1Nb2RhbC0td2FpdCc6IG1vZGFsVHlwZSA9PT0gJ3dhaXQnXG4gICAgICB9XCJcbiAgICAgIHJvbGU9XCJkaWFsb2dcIlxuICAgICAgdGFiaW5kZXg9XCIxXCJcbiAgICAgIFthdHRyLmFyaWEtbGFiZWxsZWRieV09XCJoZWFkaW5nX2lkXCJcbiAgICAgIGFyaWEtbW9kYWw9XCJ0cnVlXCJcbiAgICAgIFthdHRyLmFyaWEtZGVzY3JpYmVkYnldPVwiY29udGVudF9pZFwiXG4gICAgICBbYXR0ci5kYXRhLWlkXT1cImlkU3RyaW5nXCJcbiAgICA+XG4gICAgICA8ZGl2IGNsYXNzPVwic3Byay1vLVN0YWNrIHNwcmstby1TdGFjay0tbGFyZ2VcIj5cbiAgICAgICAgPGhlYWRlciBjbGFzcz1cInNwcmstby1TdGFja19faXRlbSBzcHJrLWMtTW9kYWxfX2hlYWRlclwiPlxuICAgICAgICAgIDxoMlxuICAgICAgICAgICAgY2xhc3M9XCJzcHJrLWMtTW9kYWxfX2hlYWRpbmcgc3Byay1iLVR5cGVEaXNwbGF5Rm91clwiXG4gICAgICAgICAgICBbaWRdPVwiaGVhZGluZ19pZFwiXG4gICAgICAgICAgPlxuICAgICAgICAgICAge3sgdGl0bGUgfX1cbiAgICAgICAgICA8L2gyPlxuXG4gICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgKm5nSWY9XCJtb2RhbFR5cGUgIT0gJ3dhaXQnXCJcbiAgICAgICAgICAgIGNsYXNzPVwic3Byay1jLU1vZGFsX19pY29uXCJcbiAgICAgICAgICAgIHR5cGU9XCJidXR0b25cIlxuICAgICAgICAgICAgYXJpYS1sYWJlbD1cIkNsb3NlIE1vZGFsXCJcbiAgICAgICAgICAgIChjbGljayk9XCJjbG9zZU1vZGFsKCRldmVudClcIlxuICAgICAgICAgID5cbiAgICAgICAgICAgIDxzcHJrLWljb25cbiAgICAgICAgICAgICAgaWNvblR5cGU9XCJjbG9zZVwiXG4gICAgICAgICAgICAgIGFkZGl0aW9uYWxDbGFzc2VzPVwic3Byay1jLUljb24tLXN0cm9rZS1jdXJyZW50LWNvbG9yXCJcbiAgICAgICAgICAgID48L3NwcmstaWNvbj5cbiAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgPC9oZWFkZXI+XG5cbiAgICAgICAgPGRpdlxuICAgICAgICAgIGNsYXNzPVwic3Byay1vLVN0YWNrX19pdGVtIHNwcmstYy1Nb2RhbF9fYm9keSBzcHJrLW8tU3RhY2sgc3Byay1vLVN0YWNrLS1tZWRpdW1cIlxuICAgICAgICA+XG4gICAgICAgICAgPGRpdlxuICAgICAgICAgICAgKm5nSWY9XCJtb2RhbFR5cGUgPT0gJ3dhaXQnXCJcbiAgICAgICAgICAgIGNsYXNzPVwic3Byay1vLVN0YWNrX19pdGVtIHNwcmstYy1TcGlubmVyIHNwcmstYy1TcGlubmVyLS1jaXJjbGUgc3Byay1jLVNwaW5uZXItLWxhcmdlIHNwcmstYy1TcGlubmVyLS1kYXJrXCJcbiAgICAgICAgICA+PC9kaXY+XG4gICAgICAgICAgPG5nLWNvbnRlbnQ+PC9uZy1jb250ZW50PlxuICAgICAgICA8L2Rpdj5cblxuICAgICAgICA8Zm9vdGVyXG4gICAgICAgICAgKm5nSWY9XCJtb2RhbFR5cGUgPT09ICdjaG9pY2UnXCJcbiAgICAgICAgICBjbGFzcz1cInNwcmstby1TdGFja19faXRlbSBzcHJrLWMtTW9kYWxfX2Zvb3RlclwiXG4gICAgICAgID5cbiAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICBjbGFzcz1cInNwcmstYy1CdXR0b24gc3Byay11LW1ybVwiXG4gICAgICAgICAgICBbYXR0ci5kYXRhLWFuYWx5dGljc109XCJjb25maXJtQW5hbHl0aWNzU3RyaW5nXCJcbiAgICAgICAgICAgIChjbGljayk9XCJlbWl0Q29uZmlybUNsaWNrKCRldmVudClcIlxuICAgICAgICAgID5cbiAgICAgICAgICAgIHt7IGNvbmZpcm1UZXh0IH19XG4gICAgICAgICAgPC9idXR0b24+XG5cbiAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICBjbGFzcz1cInNwcmstYy1CdXR0b24gc3Byay1jLUJ1dHRvbi0tdGVydGlhcnlcIlxuICAgICAgICAgICAgW2F0dHIuZGF0YS1hbmFseXRpY3NdPVwiY2FuY2VsQW5hbHl0aWNzU3RyaW5nXCJcbiAgICAgICAgICAgIChjbGljayk9XCJlbWl0Q2FuY2VsQ2xpY2soJGV2ZW50KVwiXG4gICAgICAgICAgPlxuICAgICAgICAgICAge3sgY2FuY2VsVGV4dCB9fVxuICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICA8L2Zvb3Rlcj5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuXG4gICAgPGRpdlxuICAgICAgKm5nSWY9XCJpc1Zpc2libGVcIlxuICAgICAgY2xhc3M9XCJzcHJrLWMtTW9kYWxNYXNrXCJcbiAgICAgIHRhYmluZGV4PVwiLTFcIlxuICAgICAgKGNsaWNrKT1cImNsb3NlTW9kYWwoJGV2ZW50KVwiXG4gICAgPjwvZGl2PlxuICBgXG59KVxuZXhwb3J0IGNsYXNzIFNwcmtNb2RhbENvbXBvbmVudCB7XG4gIEBJbnB1dCgpXG4gIHRpdGxlOiBzdHJpbmc7XG4gIC8qKlxuICAgKiBUaGlzIGRldGVybWluZXMgdGhlIHZhcmlhbnQgb2YgdGhlIE1vZGFsLlxuICAgKiBDYW4gYmUgYGNob2ljZWAsIGBpbmZvYCwgb3IgYHdhaXRgLlxuICAgKi9cbiAgQElucHV0KClcbiAgbW9kYWxUeXBlOiBzdHJpbmc7XG4gIC8qKlxuICAgKiBUaGUgdmFsdWUgc3VwcGxpZWQgd2lsbCBiZVxuICAgKiByZW5kZXJlZCBhcyB0aGUgdGV4dCBmb3IgdGhlIGNvbmZpcm0gYnV0dG9uLlxuICAgKi9cbiAgQElucHV0KClcbiAgY29uZmlybVRleHQgPSAnQ29uZmlybSc7XG4gIC8qKlxuICAgKiBUaGUgdmFsdWUgc3VwcGxpZWQgd2lsbCBiZSByZW5kZXJlZFxuICAgKiBhcyB0aGUgdGV4dCBmb3IgdGhlIGNhbmNlbCBidXR0b24uXG4gICAqL1xuICBASW5wdXQoKVxuICBjYW5jZWxUZXh0ID0gJ0NhbmNlbCc7XG4gIC8qKlxuICAgKiBUaGUgdmFsdWUgc3VwcGxpZWQgd2lsbCBiZSBhc3NpZ25lZCB0byB0aGVcbiAgICogYGRhdGEtYW5hbHl0aWNzYCBhdHRyaWJ1dGVcbiAgICogb24gdGhlIGNvbmZpcm0gYnV0dG9uLiBJbnRlbmRlZFxuICAgKiBmb3IgYW4gb3V0c2lkZSBsaWJyYXJ5IHRvIGNhcHR1cmUgZGF0YS5cbiAgICovXG4gIEBJbnB1dCgpXG4gIGNvbmZpcm1BbmFseXRpY3NTdHJpbmc6IHN0cmluZztcbiAgLyoqXG4gICAqIFRoZSB2YWx1ZSBzdXBwbGllZCB3aWxsIGJlIGFzc2lnbmVkIHRvIHRoZVxuICAgKiBgZGF0YS1hbmFseXRpY3NgIGF0dHJpYnV0ZVxuICAgKiBvbiB0aGUgY2FuY2VsIGJ1dHRvbi4gSW50ZW5kZWRcbiAgICogZm9yIGFuIG91dHNpZGUgbGlicmFyeSB0byBjYXB0dXJlIGRhdGEuXG4gICAqL1xuICBASW5wdXQoKVxuICBjYW5jZWxBbmFseXRpY3NTdHJpbmc6IHN0cmluZztcbiAgLyoqXG4gICAqIFRoZSB2YWx1ZSBzdXBwbGllZCB3aWxsIGJlIGFzc2lnbmVkXG4gICAqIHRvIHRoZSBgZGF0YS1pZGAgYXR0cmlidXRlIG9uIHRoZVxuICAgKiBjb21wb25lbnQuIFRoaXMgaXMgaW50ZW5kZWQgdG8gYmVcbiAgICogdXNlZCBhcyBhIHNlbGVjdG9yIGZvciBhdXRvbWF0ZWRcbiAgICogdG9vbHMuIFRoaXMgdmFsdWUgc2hvdWxkIGJlIHVuaXF1ZVxuICAgKiBwZXIgcGFnZS5cbiAgICovXG4gIEBJbnB1dCgpXG4gIGlkU3RyaW5nOiBzdHJpbmc7XG4gIC8qKlxuICAgKiBJZiBgdHJ1ZWAsIHRoZSBNb2RhbCB3aWxsIGJlIHNob3duLlxuICAgKiBJZiBgZmFsc2VgLCB0aGUgbW9kYWwgd2lsbCBub3QgYmUgc2hvd24uXG4gICAqL1xuICBASW5wdXQoKVxuICBpc1Zpc2libGUgPSBmYWxzZTtcbiAgLyoqXG4gICAqIFdoZW4gdGhlIE1vZGFsIGlzIGNsb3NlZCB0aGUgaGlkZSBldmVudCBpc1xuICAgKiBlbWl0dGVkIGFuZCBhIGNhbGxiYWNrIGZ1bmN0aW9uIGNhblxuICAgKiBiZSB0cmlnZ2VyZWQgaWYgc3VwcGxpZWQuXG4gICAqL1xuICBAT3V0cHV0KClcbiAgaGlkZSA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuICAvKipcbiAgICogQXZhaWxhYmxlIHdoZW4gdGhlIE1vZGFsIHR5cGUgaXMgYGNob2ljZWAuXG4gICAqIFRoZSBNb2RhbCB3aWxsIGVtaXQgYSBjb25maXJtIGNsaWNrIGV2ZW50XG4gICAqIHdoZW4gdGhlIGNvbmZpcm1hdGlvbiBidXR0b24gaXMgY2xpY2tlZC5cbiAgICogQSBjYWxsYmFjayBmdW5jdGlvbiBjYW4gYmUgdHJpZ2dlcmVkIGlmXG4gICAqIHN1cHBsaWVkLlxuICAgKi9cbiAgQE91dHB1dCgpXG4gIGNvbmZpcm1DbGljayA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuICAvKipcbiAgICogQXZhaWxhYmxlIHdoZW4gdGhlIE1vZGFsIHR5cGUgaXMgYGNob2ljZWAuXG4gICAqIFRoZSBNb2RhbCB3aWxsIGVtaXQgYSBjYW5jZWwgY2xpY2sgZXZlbnRcbiAgICogd2hlbiB0aGUgY2FuY2VsIGxpbmsgaXMgY2xpY2tlZC5cbiAgICogQSBjYWxsYmFjayBmdW5jdGlvbiBjYW4gYmUgdHJpZ2dlcmVkIGlmIHN1cHBsaWVkLlxuICAgKi9cbiAgQE91dHB1dCgpXG4gIGNhbmNlbENsaWNrID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG4gIC8qKlxuICAgKiBAaWdub3JlXG4gICAqL1xuICBjb21wb25lbnRJRCA9IF8udW5pcXVlSWQoKTtcbiAgLyoqXG4gICAqIEBpZ25vcmVcbiAgICovXG4gIGhlYWRpbmdfaWQgPSBgbW9kYWxIZWFkaW5nX18ke3RoaXMuY29tcG9uZW50SUR9YDtcbiAgLyoqXG4gICAqIEBpZ25vcmVcbiAgICovXG4gIGNvbnRlbnRfaWQgPSBgbW9kYWxDb250ZW50X18ke3RoaXMuY29tcG9uZW50SUR9YDtcblxuICAvKipcbiAgICogQGlnbm9yZVxuICAgKi9cbiAgQEhvc3RMaXN0ZW5lcignZG9jdW1lbnQ6a2V5ZG93bicsIFsnJGV2ZW50J10pXG4gIGhhbmRsZUtleWJvYXJkRXZlbnQoZXZlbnQ6IEtleWJvYXJkRXZlbnQpIHtcbiAgICBpZiAodGhpcy5pc1Zpc2libGUgJiYgZXZlbnQua2V5ID09PSAnRXNjYXBlJykge1xuICAgICAgdGhpcy5jbG9zZU1vZGFsKGV2ZW50KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQGlnbm9yZVxuICAgKi9cbiAgY29uc3RydWN0b3IoKSB7fVxuXG4gIC8qKlxuICAgKiBAaWdub3JlXG4gICAqL1xuICBjbG9zZU1vZGFsKGV2ZW50KTogdm9pZCB7XG4gICAgaWYgKHRoaXMubW9kYWxUeXBlICE9PSAnd2FpdCcpIHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLmhpZGUuZW1pdChldmVudCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEVtaXRzIGFuIGV2ZW50IHdoZW4gdGhlIGNvbmZpcm1hdGlvblxuICAgKiBidXR0b24gaXMgY2xpY2tlZC5cbiAgICovXG4gIGVtaXRDb25maXJtQ2xpY2soZXZlbnQpOiB2b2lkIHtcbiAgICB0aGlzLmNvbmZpcm1DbGljay5lbWl0KGV2ZW50KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBFbWl0cyBhbiBldmVudCB3aGVuIHRoZSBjYW5jZWxcbiAgICogbGluayBpcyBjbGlja2VkLlxuICAgKi9cbiAgZW1pdENhbmNlbENsaWNrKGV2ZW50KTogdm9pZCB7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICB0aGlzLmNhbmNlbENsaWNrLmVtaXQoZXZlbnQpO1xuICAgIHRoaXMuY2xvc2VNb2RhbChldmVudCk7XG4gIH1cbn1cbiJdfQ==