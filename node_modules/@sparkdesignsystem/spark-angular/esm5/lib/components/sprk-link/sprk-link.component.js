import { __decorate, __metadata } from "tslib";
import { Component, Input } from '@angular/core';
import { Router } from '@angular/router';
var SprkLinkComponent = /** @class */ (function () {
    /**
     * @ignore
     */
    function SprkLinkComponent(router) {
        this.router = router;
        /**
         * By default, the component determines if
         * the `href` is an external or internal link
         * by looking for the `:` character in the
         * `href` string. If external link functionality
         * is desired with an `href` value that contains
         * a `:` set this input to true. This overrides
         * the default and avoids using the Angular Router.
         */
        this.isExternal = false;
    }
    SprkLinkComponent.prototype.ngOnInit = function () {
        // This message is split up like this so that we can keep the line
        // length down in the editor while also logging a single unformatted
        // line of text in the console.
        var message = 'Spark Design System Warning: Spark Link has been ' +
            'refactored to be an Angular Directive. The old Angular Component ' +
            'version has been deprecated. This version will be permanently removed ' +
            'from Spark in our Summer 2020 release. To update to the new version, ' +
            'replace any instance of the <sprk-link> component in your codebase with ' +
            'the new Directive syntax.';
        console.warn(message);
        // Sets the default href if none provided
        if (this.href === '' || this.href === null || this.href === undefined) {
            this.href = '#';
            return;
        }
        // Build jump link's href
        if (this.isJumpLink(this.href)) {
            this.href = "" + this.getPathWithoutHash(this.router.url) + this.href;
        }
    };
    /**
     * @ignore
     */
    SprkLinkComponent.prototype.isExternalLink = function (value) {
        return new RegExp('^.*:', 'i').test(value);
    };
    /**
     * @ignore
     */
    SprkLinkComponent.prototype.isJumpLinkWithPage = function (value) {
        return new RegExp('^.*#.+', 'i').test(value);
    };
    /**
     * @ignore
     */
    SprkLinkComponent.prototype.isJumpLink = function (value) {
        return new RegExp('^#.+', 'i').test(value);
    };
    /**
     * @ignore
     */
    SprkLinkComponent.prototype.isNoActionLink = function (value) {
        return value === '#';
    };
    /**
     * @ignore
     */
    SprkLinkComponent.prototype.getPathWithoutHash = function (value) {
        return value.split('#')[0];
    };
    /**
     * @ignore
     */
    SprkLinkComponent.prototype.scrollToId = function () {
        var elementID = this.href.split('#').pop();
        var element = document.getElementById(elementID);
        if (element) {
            element.scrollIntoView();
        }
    };
    /**
     * @ignore
     */
    SprkLinkComponent.prototype.handleClick = function (event) {
        // Let browser handle route if external Link
        if (this.isExternalLink(this.href) || this.isExternal) {
            return;
        }
        event.preventDefault();
        // Prevent default and return
        if (this.isNoActionLink(this.href)) {
            return;
        }
        else if (this.isJumpLinkWithPage(this.href)) {
            if (this.getPathWithoutHash(this.href) ===
                this.getPathWithoutHash(this.router.url)) {
                this.scrollToId();
            }
            else {
                this.router.navigateByUrl(this.href);
            }
        }
        else {
            this.router.navigateByUrl(this.href);
        }
    };
    /**
     * @ignore
     */
    SprkLinkComponent.prototype.getClasses = function () {
        var classArray = [];
        switch (this.linkType) {
            case 'unstyled':
                break;
            case 'simple':
                classArray.push('sprk-b-Link sprk-b-Link--simple');
                break;
            case 'plain':
                classArray.push('sprk-b-Link sprk-b-Link--plain');
                break;
            case 'icon':
                classArray.push('sprk-b-Link sprk-b-Link--simple sprk-b-Link--has-icon');
                break;
            default:
                classArray.push('sprk-b-Link');
                break;
        }
        if (this.isDisabled) {
            classArray.push('sprk-b-Link--disabled');
        }
        if (this.additionalClasses) {
            this.additionalClasses.split(' ').forEach(function (className) {
                classArray.push(className);
            });
        }
        return classArray.join(' ');
    };
    SprkLinkComponent.ctorParameters = function () { return [
        { type: Router }
    ]; };
    __decorate([
        Input(),
        __metadata("design:type", String)
    ], SprkLinkComponent.prototype, "linkType", void 0);
    __decorate([
        Input(),
        __metadata("design:type", String)
    ], SprkLinkComponent.prototype, "href", void 0);
    __decorate([
        Input(),
        __metadata("design:type", String)
    ], SprkLinkComponent.prototype, "idString", void 0);
    __decorate([
        Input(),
        __metadata("design:type", String)
    ], SprkLinkComponent.prototype, "role", void 0);
    __decorate([
        Input(),
        __metadata("design:type", String)
    ], SprkLinkComponent.prototype, "id", void 0);
    __decorate([
        Input(),
        __metadata("design:type", String)
    ], SprkLinkComponent.prototype, "ariaControls", void 0);
    __decorate([
        Input(),
        __metadata("design:type", String)
    ], SprkLinkComponent.prototype, "ariaLabelledby", void 0);
    __decorate([
        Input(),
        __metadata("design:type", String)
    ], SprkLinkComponent.prototype, "ariaSelected", void 0);
    __decorate([
        Input(),
        __metadata("design:type", String)
    ], SprkLinkComponent.prototype, "ariaHidden", void 0);
    __decorate([
        Input(),
        __metadata("design:type", String)
    ], SprkLinkComponent.prototype, "ariaCurrent", void 0);
    __decorate([
        Input(),
        __metadata("design:type", String)
    ], SprkLinkComponent.prototype, "ariaExpanded", void 0);
    __decorate([
        Input(),
        __metadata("design:type", String)
    ], SprkLinkComponent.prototype, "ariaHasPopUp", void 0);
    __decorate([
        Input(),
        __metadata("design:type", String)
    ], SprkLinkComponent.prototype, "ariaLabel", void 0);
    __decorate([
        Input(),
        __metadata("design:type", String)
    ], SprkLinkComponent.prototype, "analyticsString", void 0);
    __decorate([
        Input(),
        __metadata("design:type", String)
    ], SprkLinkComponent.prototype, "target", void 0);
    __decorate([
        Input(),
        __metadata("design:type", String)
    ], SprkLinkComponent.prototype, "additionalClasses", void 0);
    __decorate([
        Input(),
        __metadata("design:type", Boolean)
    ], SprkLinkComponent.prototype, "isDisabled", void 0);
    __decorate([
        Input(),
        __metadata("design:type", Object)
    ], SprkLinkComponent.prototype, "isExternal", void 0);
    SprkLinkComponent = __decorate([
        Component({
            selector: 'sprk-link',
            template: "\n    <a\n      (click)=\"handleClick($event)\"\n      [ngClass]=\"getClasses()\"\n      [href]=\"href\"\n      [attr.data-analytics]=\"analyticsString\"\n      [attr.target]=\"target\"\n      [attr.data-id]=\"idString\"\n      [attr.disabled]=\"isDisabled\"\n      [attr.aria-controls]=\"ariaControls\"\n      [attr.aria-label]=\"ariaLabel\"\n      [attr.aria-labelledby]=\"ariaLabelledby\"\n      [attr.aria-haspopup]=\"ariaHasPopUp\"\n      [attr.role]=\"role\"\n      [attr.id]=\"id\"\n      [attr.aria-current]=\"ariaCurrent\"\n      [attr.aria-expanded]=\"ariaExpanded\"\n      [attr.aria-hidden]=\"ariaHidden\"\n      [attr.aria-selected]=\"ariaSelected\"\n    >\n      <ng-content></ng-content>\n    </a>\n  "
        })
        /**
         * @deprecate This component will be removed in
         * a future release in favor of the `sprkLink` directive.
         * Please use the Spark Link
         * directive.
         */
        ,
        __metadata("design:paramtypes", [Router])
    ], SprkLinkComponent);
    return SprkLinkComponent;
}());
export { SprkLinkComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3Byay1saW5rLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BzcGFya2Rlc2lnbnN5c3RlbS9zcGFyay1hbmd1bGFyLyIsInNvdXJjZXMiOlsibGliL2NvbXBvbmVudHMvc3Byay1saW5rL3NwcmstbGluay5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFVLE1BQU0sZUFBZSxDQUFDO0FBQ3pELE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQWlDekM7SUFDRTs7T0FFRztJQUNILDJCQUFtQixNQUFjO1FBQWQsV0FBTSxHQUFOLE1BQU0sQ0FBUTtRQXFIakM7Ozs7Ozs7O1dBUUc7UUFFSCxlQUFVLEdBQUcsS0FBSyxDQUFDO0lBL0hpQixDQUFDO0lBaUlyQyxvQ0FBUSxHQUFSO1FBRUUsa0VBQWtFO1FBQ2xFLG9FQUFvRTtRQUNwRSwrQkFBK0I7UUFDL0IsSUFBTSxPQUFPLEdBQUcsbURBQW1EO1lBQ25FLG1FQUFtRTtZQUNuRSx3RUFBd0U7WUFDeEUsdUVBQXVFO1lBQ3ZFLDBFQUEwRTtZQUMxRSwyQkFBMkIsQ0FBQztRQUU1QixPQUFPLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBRXRCLHlDQUF5QztRQUN6QyxJQUFJLElBQUksQ0FBQyxJQUFJLEtBQUssRUFBRSxJQUFJLElBQUksQ0FBQyxJQUFJLEtBQUssSUFBSSxJQUFJLElBQUksQ0FBQyxJQUFJLEtBQUssU0FBUyxFQUFFO1lBQ3JFLElBQUksQ0FBQyxJQUFJLEdBQUcsR0FBRyxDQUFDO1lBQ2hCLE9BQU87U0FDUjtRQUNELHlCQUF5QjtRQUN6QixJQUFJLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFO1lBQzlCLElBQUksQ0FBQyxJQUFJLEdBQUcsS0FBRyxJQUFJLENBQUMsa0JBQWtCLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxHQUFH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N0IsU0FBUyxDQUFDO1lBQ1QsUUFBUSxFQUFFLFdBQVc7WUFDckIsUUFBUSxFQUFFLDhzQkFzQlQ7U0FDRixDQUFDO1FBQ0Y7Ozs7O1dBS0c7O3lDQUswQixNQUFNO09BSnRCLGlCQUFpQixDQXNRN0I7SUFBRCx3QkFBQztDQUFBLEFBdFFELElBc1FDO1NBdFFZLGlCQUFpQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgSW5wdXQsIE9uSW5pdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgUm91dGVyIH0gZnJvbSAnQGFuZ3VsYXIvcm91dGVyJztcbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ3NwcmstbGluaycsXG4gIHRlbXBsYXRlOiBgXG4gICAgPGFcbiAgICAgIChjbGljayk9XCJoYW5kbGVDbGljaygkZXZlbnQpXCJcbiAgICAgIFtuZ0NsYXNzXT1cImdldENsYXNzZXMoKVwiXG4gICAgICBbaHJlZl09XCJocmVmXCJcbiAgICAgIFthdHRyLmRhdGEtYW5hbHl0aWNzXT1cImFuYWx5dGljc1N0cmluZ1wiXG4gICAgICBbYXR0ci50YXJnZXRdPVwidGFyZ2V0XCJcbiAgICAgIFthdHRyLmRhdGEtaWRdPVwiaWRTdHJpbmdcIlxuICAgICAgW2F0dHIuZGlzYWJsZWRdPVwiaXNEaXNhYmxlZFwiXG4gICAgICBbYXR0ci5hcmlhLWNvbnRyb2xzXT1cImFyaWFDb250cm9sc1wiXG4gICAgICBbYXR0ci5hcmlhLWxhYmVsXT1cImFyaWFMYWJlbFwiXG4gICAgICBbYXR0ci5hcmlhLWxhYmVsbGVkYnldPVwiYXJpYUxhYmVsbGVkYnlcIlxuICAgICAgW2F0dHIuYXJpYS1oYXNwb3B1cF09XCJhcmlhSGFzUG9wVXBcIlxuICAgICAgW2F0dHIucm9sZV09XCJyb2xlXCJcbiAgICAgIFthdHRyLmlkXT1cImlkXCJcbiAgICAgIFthdHRyLmFyaWEtY3VycmVudF09XCJhcmlhQ3VycmVudFwiXG4gICAgICBbYXR0ci5hcmlhLWV4cGFuZGVkXT1cImFyaWFFeHBhbmRlZFwiXG4gICAgICBbYXR0ci5hcmlhLWhpZGRlbl09XCJhcmlhSGlkZGVuXCJcbiAgICAgIFthdHRyLmFyaWEtc2VsZWN0ZWRdPVwiYXJpYVNlbGVjdGVkXCJcbiAgICA+XG4gICAgICA8bmctY29udGVudD48L25nLWNvbnRlbnQ+XG4gICAgPC9hPlxuICBgXG59KVxuLyoqXG4gKiBAZGVwcmVjYXRlIFRoaXMgY29tcG9uZW50IHdpbGwgYmUgcmVtb3ZlZCBpblxuICogYSBmdXR1cmUgcmVsZWFzZSBpbiBmYXZvciBvZiB0aGUgYHNwcmtMaW5rYCBkaXJlY3RpdmUuXG4gKiBQbGVhc2UgdXNlIHRoZSBTcGFyayBMaW5rXG4gKiBkaXJlY3RpdmUuXG4gKi9cbmV4cG9ydCBjbGFzcyBTcHJrTGlua0NvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XG4gIC8qKlxuICAgKiBAaWdub3JlXG4gICAqL1xuICBjb25zdHJ1Y3RvcihwdWJsaWMgcm91dGVyOiBSb3V0ZXIpIHt9XG5cbiAgLyoqXG4gICAqIFdpbGwgY2F1c2UgdGhlIGFwcHJvcHJpYXRlIHZhcmlhbnQgdHlwZSB0byByZW5kZXIuXG4gICAqIE9wdGlvbmFsIHZhbHVlcyBhcmU6IGBzaW1wbGVgLCBgaWNvbmAsIGB1bnN0eWxlZGAgb3IgYHBsYWluYC5cbiAgICogSWYgb21pdHRlZCwgdGhlIGRlZmF1bHQgU3BhcmsgTGluayBjbGFzcyBpcyBhcHBsaWVkLlxuICAgKiBUaGUgYHVuc3R5bGVkYCB2YXJpYW50IHdpbGwgcmVuZGVyIGFuIGBocmVmYCB3aXRoIG5vXG4gICAqIENTUyBjbGFzc2VzLlxuICAgKi9cbiAgQElucHV0KClcbiAgbGlua1R5cGU6IHN0cmluZztcbiAgLyoqXG4gICAqIFRoZSBgaHJlZmAgdmFsdWUgb2YgdGhlIGxpbmsuIElmIG9taXR0ZWQsXG4gICAqIHRoZSBocmVmIHdpbGwgYmUgc2V0IHRvIGAjYFxuICAgKiBhbmQgdGhlIHJvdXRpbmcgd2lsbCBiZSBkaXNhYmxlZC4gSWZcbiAgICogc2V0IHRvIHJlZmVyZW5jZSBhbiBJRCB0aGVuIHRoZSBwYWdlXG4gICAqIHdpbGwgc2Nyb2xsIHRvIHRoYXQgYW5jaG9yIGFzIG5vcm1hbC5cbiAgICovXG4gIEBJbnB1dCgpXG4gIGhyZWY6IHN0cmluZztcbiAgLyoqXG4gICAqIFRoZSB2YWx1ZSBzdXBwbGllZCB3aWxsIGJlIGFzc2lnbmVkXG4gICAqIHRvIHRoZSBgZGF0YS1pZGAgYXR0cmlidXRlIG9uIHRoZVxuICAgKiBjb21wb25lbnQuIFRoaXMgaXMgaW50ZW5kZWQgdG8gYmVcbiAgICogdXNlZCBhcyBhIHNlbGVjdG9yIGZvciBhdXRvbWF0ZWRcbiAgICogdG9vbHMuIFRoaXMgdmFsdWUgc2hvdWxkIGJlIHVuaXF1ZVxuICAgKiBwZXIgcGFnZS5cbiAgICovXG4gIEBJbnB1dCgpXG4gIGlkU3RyaW5nOiBzdHJpbmc7XG4gIC8qKlxuICAgKiBWYWx1ZSBmb3IgdGhlIGByb2xlYFxuICAgKiBhdHRyaWJ1dGUgb2YgdGhlIGxpbmsuXG4gICAqL1xuICBASW5wdXQoKVxuICByb2xlOiBzdHJpbmc7XG4gIC8qKlxuICAgKiBUaGUgc3RyaW5nIHRoYXQgd2lsbCBiZVxuICAgKiBhc3NpZ25lZCB0byB0aGUgYGlkYCBhdHRyaWJ1dGUgb2ZcbiAgICogdGhlIGxpbmsuXG4gICAqL1xuICBASW5wdXQoKVxuICBpZDogc3RyaW5nO1xuICAvKipcbiAgICogRXhwZWN0cyBhIHZhbHVlIHRvIGFzc2lnbiB0byB0aGVcbiAgICogYGFyaWEtY29udHJvbHNgIGF0dHJpYnV0ZSBvZiB0aGUgbGluay5cbiAgICovXG4gIEBJbnB1dCgpXG4gIGFyaWFDb250cm9sczogc3RyaW5nO1xuICAvKipcbiAgICogRXhwZWN0cyBhIHZhbHVlIHRvIGFzc2lnbiB0b1xuICAgKiB0aGUgYGFyaWEtbGFiZWxsZWRieWAgYXR0cmlidXRlIG9mIHRoZSBsaW5rLlxuICAgKi9cbiAgQElucHV0KClcbiAgYXJpYUxhYmVsbGVkYnk6IHN0cmluZztcbiAgLyoqXG4gICAqIEV4cGVjdHMgYSB2YWx1ZSB0byBhc3NpZ24gdG9cbiAgICogdGhlIGBhcmlhLXNlbGVjdGVkYCBhdHRyaWJ1dGUgb2YgdGhlIGxpbmsuXG4gICAqL1xuICBASW5wdXQoKVxuICBhcmlhU2VsZWN0ZWQ6IHN0cmluZztcbiAgLyoqXG4gICAqIEV4cGVjdHMgYSB2YWx1ZSB0byBhc3NpZ24gdG9cbiAgICogdGhlIGBhcmlhLWhpZGRlbmAgYXR0cmlidXRlIG9mIHRoZSBsaW5rLlxuICAgKi9cbiAgQElucHV0KClcbiAgYXJpYUhpZGRlbjogc3RyaW5nO1xuICAvKipcbiAgICogRXhwZWN0cyBhIHZhbHVlIHRvIGFzc2lnblxuICAgKiB0byB0aGUgYGFyaWEtY3VycmVuYHQgYXR0cmlidXRlIG9mIHRoZSBsaW5rLlxuICAgKi9cbiAgQElucHV0KClcbiAgYXJpYUN1cnJlbnQ6IHN0cmluZztcbiAgLyoqXG4gICAqIEV4cGVjdHMgYSB2YWx1ZSB0byBhc3NpZ24gdG9cbiAgICogdGhlIGBhcmlhLWV4cGFuZGVkIGBhdHRyaWJ1dGUgb2YgdGhlIGxpbmsuXG4gICAqL1xuICBASW5wdXQoKVxuICBhcmlhRXhwYW5kZWQ6IHN0cmluZztcbiAgLyoqXG4gICAqIEV4cGVjdHMgYSB2YWx1ZSB0byBhc3NpZ25cbiAgICogdG8gdGhlIGBhcmlhLWhhc3BvcHVwYCBhdHRyaWJ1dGUgb2YgdGhlIGxpbmsuXG4gICAqL1xuICBASW5wdXQoKVxuICBhcmlhSGFzUG9wVXA6IHN0cmluZztcbiAgLyoqXG4gICAqIEV4cGVjdHMgYSB2YWx1ZSB0byBhc3NpZ24gdG9cbiAgICogdGhlIGBhcmlhLWxhYmVsYCBhdHRyaWJ1dGUgb2YgdGhlIGxpbmsuXG4gICAqL1xuICBASW5wdXQoKVxuICBhcmlhTGFiZWw6IHN0cmluZztcbiAgLyoqXG4gICAqIFRoZSB2YWx1ZSBzdXBwbGllZCB3aWxsIGJlIGFzc2lnbmVkIHRvIHRoZVxuICAgKiBgZGF0YS1hbmFseXRpY3NgIGF0dHJpYnV0ZSBvbiB0aGUgY29tcG9uZW50LlxuICAgKiBJbnRlbmRlZCBmb3IgYW4gb3V0c2lkZVxuICAgKiBsaWJyYXJ5IHRvIGNhcHR1cmUgZGF0YS5cbiAgICovXG4gIEBJbnB1dCgpXG4gIGFuYWx5dGljc1N0cmluZzogc3RyaW5nO1xuICAvKipcbiAgICogRXhwZWN0cyBhIHZhbHVlIHRvIGFzc2lnbiB0b1xuICAgKiB0aGUgYHRhcmdldGAgYXR0cmlidXRlIG9mIHRoZSBsaW5rLlxuICAgKi9cbiAgQElucHV0KClcbiAgdGFyZ2V0OiBzdHJpbmc7XG4gIC8qKlxuICAgKiBFeHBlY3RzIGEgc3BhY2Ugc2VwYXJhdGVkIHN0cmluZ1xuICAgKiBvZiBjbGFzc2VzIHRvIGJlIGFkZGVkIHRvIHRoZVxuICAgKiBjb21wb25lbnQuXG4gICAqL1xuICBASW5wdXQoKVxuICBhZGRpdGlvbmFsQ2xhc3Nlczogc3RyaW5nO1xuICAvKipcbiAgICogSWYgYHRydWVgLCB3aWxsIHNldCBkaXNhYmxlZCBzdHlsZXMgb24gdGhlIGxpbmsuXG4gICAqL1xuICBASW5wdXQoKVxuICBpc0Rpc2FibGVkOiBib29sZWFuO1xuICAvKipcbiAgICogQnkgZGVmYXVsdCwgdGhlIGNvbXBvbmVudCBkZXRlcm1pbmVzIGlmXG4gICAqIHRoZSBgaHJlZmAgaXMgYW4gZXh0ZXJuYWwgb3IgaW50ZXJuYWwgbGlua1xuICAgKiBieSBsb29raW5nIGZvciB0aGUgYDpgIGNoYXJhY3RlciBpbiB0aGVcbiAgICogYGhyZWZgIHN0cmluZy4gSWYgZXh0ZXJuYWwgbGluayBmdW5jdGlvbmFsaXR5XG4gICAqIGlzIGRlc2lyZWQgd2l0aCBhbiBgaHJlZmAgdmFsdWUgdGhhdCBjb250YWluc1xuICAgKiBhIGA6YCBzZXQgdGhpcyBpbnB1dCB0byB0cnVlLiBUaGlzIG92ZXJyaWRlc1xuICAgKiB0aGUgZGVmYXVsdCBhbmQgYXZvaWRzIHVzaW5nIHRoZSBBbmd1bGFyIFJvdXRlci5cbiAgICovXG4gIEBJbnB1dCgpXG4gIGlzRXh0ZXJuYWwgPSBmYWxzZTtcblxuICBuZ09uSW5pdCgpIHtcblxuICAgIC8vIFRoaXMgbWVzc2FnZSBpcyBzcGxpdCB1cCBsaWtlIHRoaXMgc28gdGhhdCB3ZSBjYW4ga2VlcCB0aGUgbGluZVxuICAgIC8vIGxlbmd0aCBkb3duIGluIHRoZSBlZGl0b3Igd2hpbGUgYWxzbyBsb2dnaW5nIGEgc2luZ2xlIHVuZm9ybWF0dGVkXG4gICAgLy8gbGluZSBvZiB0ZXh0IGluIHRoZSBjb25zb2xlLlxuICAgIGNvbnN0IG1lc3NhZ2UgPSAnU3BhcmsgRGVzaWduIFN5c3RlbSBXYXJuaW5nOiBTcGFyayBMaW5rIGhhcyBiZWVuICcgK1xuICAgICdyZWZhY3RvcmVkIHRvIGJlIGFuIEFuZ3VsYXIgRGlyZWN0aXZlLiBUaGUgb2xkIEFuZ3VsYXIgQ29tcG9uZW50ICcgK1xuICAgICd2ZXJzaW9uIGhhcyBiZWVuIGRlcHJlY2F0ZWQuIFRoaXMgdmVyc2lvbiB3aWxsIGJlIHBlcm1hbmVudGx5IHJlbW92ZWQgJyArXG4gICAgJ2Zyb20gU3BhcmsgaW4gb3VyIFN1bW1lciAyMDIwIHJlbGVhc2UuIFRvIHVwZGF0ZSB0byB0aGUgbmV3IHZlcnNpb24sICcgK1xuICAgICdyZXBsYWNlIGFueSBpbnN0YW5jZSBvZiB0aGUgPHNwcmstbGluaz4gY29tcG9uZW50IGluIHlvdXIgY29kZWJhc2Ugd2l0aCAnICtcbiAgICAndGhlIG5ldyBEaXJlY3RpdmUgc3ludGF4Lic7XG5cbiAgICBjb25zb2xlLndhcm4obWVzc2FnZSk7XG5cbiAgICAvLyBTZXRzIHRoZSBkZWZhdWx0IGhyZWYgaWYgbm9uZSBwcm92aWRlZFxuICAgIGlmICh0aGlzLmhyZWYgPT09ICcnIHx8IHRoaXMuaHJlZiA9PT0gbnVsbCB8fCB0aGlzLmhyZWYgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhpcy5ocmVmID0gJyMnO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICAvLyBCdWlsZCBqdW1wIGxpbmsncyBocmVmXG4gICAgaWYgKHRoaXMuaXNKdW1wTGluayh0aGlzLmhyZWYpKSB7XG4gICAgICB0aGlzLmhyZWYgPSBgJHt0aGlzLmdldFBhdGhXaXRob3V0SGFzaCh0aGlzLnJvdXRlci51cmwpfSR7dGhpcy5ocmVmfWA7XG4gICAgfVxuICB9XG4gIC8qKlxuICAgKiBAaWdub3JlXG4gICAqL1xuICBpc0V4dGVybmFsTGluayh2YWx1ZSk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBuZXcgUmVnRXhwKCdeLio6JywgJ2knKS50ZXN0KHZhbHVlKTtcbiAgfVxuICAvKipcbiAgICogQGlnbm9yZVxuICAgKi9cbiAgaXNKdW1wTGlua1dpdGhQYWdlKHZhbHVlKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIG5ldyBSZWdFeHAoJ14uKiMuKycsICdpJykudGVzdCh2YWx1ZSk7XG4gIH1cbiAgLyoqXG4gICAqIEBpZ25vcmVcbiAgICovXG4gIGlzSnVtcExpbmsodmFsdWUpOiBib29sZWFuIHtcbiAgICByZXR1cm4gbmV3IFJlZ0V4cCgnXiMuKycsICdpJykudGVzdCh2YWx1ZSk7XG4gIH1cbiAgLyoqXG4gICAqIEBpZ25vcmVcbiAgICovXG4gIGlzTm9BY3Rpb25MaW5rKHZhbHVlKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHZhbHVlID09PSAnIyc7XG4gIH1cbiAgLyoqXG4gICAqIEBpZ25vcmVcbiAgICovXG4gIGdldFBhdGhXaXRob3V0SGFzaCh2YWx1ZSk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHZhbHVlLnNwbGl0KCcjJylbMF07XG4gIH1cbiAgLyoqXG4gICAqIEBpZ25vcmVcbiAgICovXG4gIHNjcm9sbFRvSWQoKSB7XG4gICAgY29uc3QgZWxlbWVudElEID0gdGhpcy5ocmVmLnNwbGl0KCcjJykucG9wKCk7XG4gICAgY29uc3QgZWxlbWVudDogSFRNTEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChlbGVtZW50SUQpO1xuICAgIGlmIChlbGVtZW50KSB7XG4gICAgICBlbGVtZW50LnNjcm9sbEludG9WaWV3KCk7XG4gICAgfVxuICB9XG4gIC8qKlxuICAgKiBAaWdub3JlXG4gICAqL1xuICBoYW5kbGVDbGljayhldmVudCk6IHZvaWQge1xuICAgIC8vIExldCBicm93c2VyIGhhbmRsZSByb3V0ZSBpZiBleHRlcm5hbCBMaW5rXG4gICAgaWYgKHRoaXMuaXNFeHRlcm5hbExpbmsodGhpcy5ocmVmKSB8fCB0aGlzLmlzRXh0ZXJuYWwpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgLy8gUHJldmVudCBkZWZhdWx0IGFuZCByZXR1cm5cbiAgICBpZiAodGhpcy5pc05vQWN0aW9uTGluayh0aGlzLmhyZWYpKSB7XG4gICAgICByZXR1cm47XG4gICAgfSBlbHNlIGlmICh0aGlzLmlzSnVtcExpbmtXaXRoUGFnZSh0aGlzLmhyZWYpKSB7XG4gICAgICBpZiAoXG4gICAgICAgIHRoaXMuZ2V0UGF0aFdpdGhvdXRIYXNoKHRoaXMuaHJlZikgPT09XG4gICAgICAgIHRoaXMuZ2V0UGF0aFdpdGhvdXRIYXNoKHRoaXMucm91dGVyLnVybClcbiAgICAgICkge1xuICAgICAgICB0aGlzLnNjcm9sbFRvSWQoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMucm91dGVyLm5hdmlnYXRlQnlVcmwodGhpcy5ocmVmKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5yb3V0ZXIubmF2aWdhdGVCeVVybCh0aGlzLmhyZWYpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBAaWdub3JlXG4gICAqL1xuICBnZXRDbGFzc2VzKCk6IHN0cmluZyB7XG4gICAgY29uc3QgY2xhc3NBcnJheTogc3RyaW5nW10gPSBbXTtcblxuICAgIHN3aXRjaCAodGhpcy5saW5rVHlwZSkge1xuICAgICAgY2FzZSAndW5zdHlsZWQnOlxuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3NpbXBsZSc6XG4gICAgICAgIGNsYXNzQXJyYXkucHVzaCgnc3Byay1iLUxpbmsgc3Byay1iLUxpbmstLXNpbXBsZScpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3BsYWluJzpcbiAgICAgICAgY2xhc3NBcnJheS5wdXNoKCdzcHJrLWItTGluayBzcHJrLWItTGluay0tcGxhaW4nKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdpY29uJzpcbiAgICAgICAgY2xhc3NBcnJheS5wdXNoKFxuICAgICAgICAgICdzcHJrLWItTGluayBzcHJrLWItTGluay0tc2ltcGxlIHNwcmstYi1MaW5rLS1oYXMtaWNvbidcbiAgICAgICAgKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICBjbGFzc0FycmF5LnB1c2goJ3NwcmstYi1MaW5rJyk7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmlzRGlzYWJsZWQpIHtcbiAgICAgIGNsYXNzQXJyYXkucHVzaCgnc3Byay1iLUxpbmstLWRpc2FibGVkJyk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuYWRkaXRpb25hbENsYXNzZXMpIHtcbiAgICAgIHRoaXMuYWRkaXRpb25hbENsYXNzZXMuc3BsaXQoJyAnKS5mb3JFYWNoKGNsYXNzTmFtZSA9PiB7XG4gICAgICAgIGNsYXNzQXJyYXkucHVzaChjbGFzc05hbWUpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNsYXNzQXJyYXkuam9pbignICcpO1xuICB9XG59XG4iXX0=