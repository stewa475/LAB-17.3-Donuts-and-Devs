import { __decorate, __metadata } from "tslib";
import { Component, Input } from '@angular/core';
import { Router } from '@angular/router';
let SprkLinkComponent = 
/**
 * @deprecate This component will be removed in
 * a future release in favor of the `sprkLink` directive.
 * Please use the Spark Link
 * directive.
 */
class SprkLinkComponent {
    /**
     * @ignore
     */
    constructor(router) {
        this.router = router;
        /**
         * By default, the component determines if
         * the `href` is an external or internal link
         * by looking for the `:` character in the
         * `href` string. If external link functionality
         * is desired with an `href` value that contains
         * a `:` set this input to true. This overrides
         * the default and avoids using the Angular Router.
         */
        this.isExternal = false;
    }
    ngOnInit() {
        // This message is split up like this so that we can keep the line
        // length down in the editor while also logging a single unformatted
        // line of text in the console.
        const message = 'Spark Design System Warning: Spark Link has been ' +
            'refactored to be an Angular Directive. The old Angular Component ' +
            'version has been deprecated. This version will be permanently removed ' +
            'from Spark in our Summer 2020 release. To update to the new version, ' +
            'replace any instance of the <sprk-link> component in your codebase with ' +
            'the new Directive syntax.';
        console.warn(message);
        // Sets the default href if none provided
        if (this.href === '' || this.href === null || this.href === undefined) {
            this.href = '#';
            return;
        }
        // Build jump link's href
        if (this.isJumpLink(this.href)) {
            this.href = `${this.getPathWithoutHash(this.router.url)}${this.href}`;
        }
    }
    /**
     * @ignore
     */
    isExternalLink(value) {
        return new RegExp('^.*:', 'i').test(value);
    }
    /**
     * @ignore
     */
    isJumpLinkWithPage(value) {
        return new RegExp('^.*#.+', 'i').test(value);
    }
    /**
     * @ignore
     */
    isJumpLink(value) {
        return new RegExp('^#.+', 'i').test(value);
    }
    /**
     * @ignore
     */
    isNoActionLink(value) {
        return value === '#';
    }
    /**
     * @ignore
     */
    getPathWithoutHash(value) {
        return value.split('#')[0];
    }
    /**
     * @ignore
     */
    scrollToId() {
        const elementID = this.href.split('#').pop();
        const element = document.getElementById(elementID);
        if (element) {
            element.scrollIntoView();
        }
    }
    /**
     * @ignore
     */
    handleClick(event) {
        // Let browser handle route if external Link
        if (this.isExternalLink(this.href) || this.isExternal) {
            return;
        }
        event.preventDefault();
        // Prevent default and return
        if (this.isNoActionLink(this.href)) {
            return;
        }
        else if (this.isJumpLinkWithPage(this.href)) {
            if (this.getPathWithoutHash(this.href) ===
                this.getPathWithoutHash(this.router.url)) {
                this.scrollToId();
            }
            else {
                this.router.navigateByUrl(this.href);
            }
        }
        else {
            this.router.navigateByUrl(this.href);
        }
    }
    /**
     * @ignore
     */
    getClasses() {
        const classArray = [];
        switch (this.linkType) {
            case 'unstyled':
                break;
            case 'simple':
                classArray.push('sprk-b-Link sprk-b-Link--simple');
                break;
            case 'plain':
                classArray.push('sprk-b-Link sprk-b-Link--plain');
                break;
            case 'icon':
                classArray.push('sprk-b-Link sprk-b-Link--simple sprk-b-Link--has-icon');
                break;
            default:
                classArray.push('sprk-b-Link');
                break;
        }
        if (this.isDisabled) {
            classArray.push('sprk-b-Link--disabled');
        }
        if (this.additionalClasses) {
            this.additionalClasses.split(' ').forEach(className => {
                classArray.push(className);
            });
        }
        return classArray.join(' ');
    }
};
SprkLinkComponent.ctorParameters = () => [
    { type: Router }
];
__decorate([
    Input(),
    __metadata("design:type", String)
], SprkLinkComponent.prototype, "linkType", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], SprkLinkComponent.prototype, "href", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], SprkLinkComponent.prototype, "idString", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], SprkLinkComponent.prototype, "role", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], SprkLinkComponent.prototype, "id", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], SprkLinkComponent.prototype, "ariaControls", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], SprkLinkComponent.prototype, "ariaLabelledby", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], SprkLinkComponent.prototype, "ariaSelected", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], SprkLinkComponent.prototype, "ariaHidden", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], SprkLinkComponent.prototype, "ariaCurrent", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], SprkLinkComponent.prototype, "ariaExpanded", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], SprkLinkComponent.prototype, "ariaHasPopUp", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], SprkLinkComponent.prototype, "ariaLabel", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], SprkLinkComponent.prototype, "analyticsString", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], SprkLinkComponent.prototype, "target", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], SprkLinkComponent.prototype, "additionalClasses", void 0);
__decorate([
    Input(),
    __metadata("design:type", Boolean)
], SprkLinkComponent.prototype, "isDisabled", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object)
], SprkLinkComponent.prototype, "isExternal", void 0);
SprkLinkComponent = __decorate([
    Component({
        selector: 'sprk-link',
        template: `
    <a
      (click)="handleClick($event)"
      [ngClass]="getClasses()"
      [href]="href"
      [attr.data-analytics]="analyticsString"
      [attr.target]="target"
      [attr.data-id]="idString"
      [attr.disabled]="isDisabled"
      [attr.aria-controls]="ariaControls"
      [attr.aria-label]="ariaLabel"
      [attr.aria-labelledby]="ariaLabelledby"
      [attr.aria-haspopup]="ariaHasPopUp"
      [attr.role]="role"
      [attr.id]="id"
      [attr.aria-current]="ariaCurrent"
      [attr.aria-expanded]="ariaExpanded"
      [attr.aria-hidden]="ariaHidden"
      [attr.aria-selected]="ariaSelected"
    >
      <ng-content></ng-content>
    </a>
  `
    })
    /**
     * @deprecate This component will be removed in
     * a future release in favor of the `sprkLink` directive.
     * Please use the Spark Link
     * directive.
     */
    ,
    __metadata("design:paramtypes", [Router])
], SprkLinkComponent);
export { SprkLinkComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3Byay1saW5rLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BzcGFya2Rlc2lnbnN5c3RlbS9zcGFyay1hbmd1bGFyLyIsInNvdXJjZXMiOlsibGliL2NvbXBvbmVudHMvc3Byay1saW5rL3NwcmstbGluay5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFVLE1BQU0sZUFBZSxDQUFDO0FBQ3pELE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQWlDekMsSUFBYSxpQkFBaUI7QUFOOUI7Ozs7O0dBS0c7QUFDSCxNQUFhLGlCQUFpQjtJQUM1Qjs7T0FFRztJQUNILFlBQW1CLE1BQWM7UUFBZCxXQUFNLEdBQU4sTUFBTSxDQUFRO1FBcUhqQzs7Ozs7Ozs7V0FRRztRQUVILGVBQVUsR0FBRyxLQUFLLENBQUM7SUEvSGlCLENBQUM7SUFpSXJDLFFBQVE7UUFFTixrRUFBa0U7UUFDbEUsb0VBQW9FO1FBQ3BFLCtCQUErQjtRQUMvQixNQUFNLE9BQU8sR0FBRyxtREFBbUQ7WUFDbkUsbUVBQW1FO1lBQ25FLHdFQUF3RTtZQUN4RSx1RUFBdUU7WUFDdkUsMEVBQTBFO1lBQzFFLDJCQUEyQixDQUFDO1FBRTVCLE9BQU8sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7UUFFdEIseUNBQXlDO1FBQ3pDLElBQUksSUFBSSxDQUFDLElBQUksS0FBSyxFQUFFLElBQUksSUFBSSxDQUFDLElBQUksS0FBSyxJQUFJLElBQUksSUFBSSxDQUFDLElBQUksS0FBSyxTQUFTLEVBQUU7WUFDckUsSUFBSSxDQUFDLElBQUksR0FBRyxHQUFHLENBQUM7WUFDaEIsT0FBTztTQUNSO1FBQ0QseUJBQXlCO1FBQ3pCLElBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUU7WUFDOUIsSUFBSSxDQUFDLElBQUksR0FBRyxHQUFHLElBQUksQ0FB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aUI7SUFoQzdCLFNBQVMsQ0FBQztRQUNULFFBQVEsRUFBRSxXQUFXO1FBQ3JCLFFBQVEsRUFBRTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztHQXNCVDtLQUNGLENBQUM7SUFDRjs7Ozs7T0FLRzs7cUNBSzBCLE1BQU07R0FKdEIsaUJBQWlCLENBc1E3QjtTQXRRWSxpQkFBaUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIElucHV0LCBPbkluaXQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IFJvdXRlciB9IGZyb20gJ0Bhbmd1bGFyL3JvdXRlcic7XG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdzcHJrLWxpbmsnLFxuICB0ZW1wbGF0ZTogYFxuICAgIDxhXG4gICAgICAoY2xpY2spPVwiaGFuZGxlQ2xpY2soJGV2ZW50KVwiXG4gICAgICBbbmdDbGFzc109XCJnZXRDbGFzc2VzKClcIlxuICAgICAgW2hyZWZdPVwiaHJlZlwiXG4gICAgICBbYXR0ci5kYXRhLWFuYWx5dGljc109XCJhbmFseXRpY3NTdHJpbmdcIlxuICAgICAgW2F0dHIudGFyZ2V0XT1cInRhcmdldFwiXG4gICAgICBbYXR0ci5kYXRhLWlkXT1cImlkU3RyaW5nXCJcbiAgICAgIFthdHRyLmRpc2FibGVkXT1cImlzRGlzYWJsZWRcIlxuICAgICAgW2F0dHIuYXJpYS1jb250cm9sc109XCJhcmlhQ29udHJvbHNcIlxuICAgICAgW2F0dHIuYXJpYS1sYWJlbF09XCJhcmlhTGFiZWxcIlxuICAgICAgW2F0dHIuYXJpYS1sYWJlbGxlZGJ5XT1cImFyaWFMYWJlbGxlZGJ5XCJcbiAgICAgIFthdHRyLmFyaWEtaGFzcG9wdXBdPVwiYXJpYUhhc1BvcFVwXCJcbiAgICAgIFthdHRyLnJvbGVdPVwicm9sZVwiXG4gICAgICBbYXR0ci5pZF09XCJpZFwiXG4gICAgICBbYXR0ci5hcmlhLWN1cnJlbnRdPVwiYXJpYUN1cnJlbnRcIlxuICAgICAgW2F0dHIuYXJpYS1leHBhbmRlZF09XCJhcmlhRXhwYW5kZWRcIlxuICAgICAgW2F0dHIuYXJpYS1oaWRkZW5dPVwiYXJpYUhpZGRlblwiXG4gICAgICBbYXR0ci5hcmlhLXNlbGVjdGVkXT1cImFyaWFTZWxlY3RlZFwiXG4gICAgPlxuICAgICAgPG5nLWNvbnRlbnQ+PC9uZy1jb250ZW50PlxuICAgIDwvYT5cbiAgYFxufSlcbi8qKlxuICogQGRlcHJlY2F0ZSBUaGlzIGNvbXBvbmVudCB3aWxsIGJlIHJlbW92ZWQgaW5cbiAqIGEgZnV0dXJlIHJlbGVhc2UgaW4gZmF2b3Igb2YgdGhlIGBzcHJrTGlua2AgZGlyZWN0aXZlLlxuICogUGxlYXNlIHVzZSB0aGUgU3BhcmsgTGlua1xuICogZGlyZWN0aXZlLlxuICovXG5leHBvcnQgY2xhc3MgU3Bya0xpbmtDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xuICAvKipcbiAgICogQGlnbm9yZVxuICAgKi9cbiAgY29uc3RydWN0b3IocHVibGljIHJvdXRlcjogUm91dGVyKSB7fVxuXG4gIC8qKlxuICAgKiBXaWxsIGNhdXNlIHRoZSBhcHByb3ByaWF0ZSB2YXJpYW50IHR5cGUgdG8gcmVuZGVyLlxuICAgKiBPcHRpb25hbCB2YWx1ZXMgYXJlOiBgc2ltcGxlYCwgYGljb25gLCBgdW5zdHlsZWRgIG9yIGBwbGFpbmAuXG4gICAqIElmIG9taXR0ZWQsIHRoZSBkZWZhdWx0IFNwYXJrIExpbmsgY2xhc3MgaXMgYXBwbGllZC5cbiAgICogVGhlIGB1bnN0eWxlZGAgdmFyaWFudCB3aWxsIHJlbmRlciBhbiBgaHJlZmAgd2l0aCBub1xuICAgKiBDU1MgY2xhc3Nlcy5cbiAgICovXG4gIEBJbnB1dCgpXG4gIGxpbmtUeXBlOiBzdHJpbmc7XG4gIC8qKlxuICAgKiBUaGUgYGhyZWZgIHZhbHVlIG9mIHRoZSBsaW5rLiBJZiBvbWl0dGVkLFxuICAgKiB0aGUgaHJlZiB3aWxsIGJlIHNldCB0byBgI2BcbiAgICogYW5kIHRoZSByb3V0aW5nIHdpbGwgYmUgZGlzYWJsZWQuIElmXG4gICAqIHNldCB0byByZWZlcmVuY2UgYW4gSUQgdGhlbiB0aGUgcGFnZVxuICAgKiB3aWxsIHNjcm9sbCB0byB0aGF0IGFuY2hvciBhcyBub3JtYWwuXG4gICAqL1xuICBASW5wdXQoKVxuICBocmVmOiBzdHJpbmc7XG4gIC8qKlxuICAgKiBUaGUgdmFsdWUgc3VwcGxpZWQgd2lsbCBiZSBhc3NpZ25lZFxuICAgKiB0byB0aGUgYGRhdGEtaWRgIGF0dHJpYnV0ZSBvbiB0aGVcbiAgICogY29tcG9uZW50LiBUaGlzIGlzIGludGVuZGVkIHRvIGJlXG4gICAqIHVzZWQgYXMgYSBzZWxlY3RvciBmb3IgYXV0b21hdGVkXG4gICAqIHRvb2xzLiBUaGlzIHZhbHVlIHNob3VsZCBiZSB1bmlxdWVcbiAgICogcGVyIHBhZ2UuXG4gICAqL1xuICBASW5wdXQoKVxuICBpZFN0cmluZzogc3RyaW5nO1xuICAvKipcbiAgICogVmFsdWUgZm9yIHRoZSBgcm9sZWBcbiAgICogYXR0cmlidXRlIG9mIHRoZSBsaW5rLlxuICAgKi9cbiAgQElucHV0KClcbiAgcm9sZTogc3RyaW5nO1xuICAvKipcbiAgICogVGhlIHN0cmluZyB0aGF0IHdpbGwgYmVcbiAgICogYXNzaWduZWQgdG8gdGhlIGBpZGAgYXR0cmlidXRlIG9mXG4gICAqIHRoZSBsaW5rLlxuICAgKi9cbiAgQElucHV0KClcbiAgaWQ6IHN0cmluZztcbiAgLyoqXG4gICAqIEV4cGVjdHMgYSB2YWx1ZSB0byBhc3NpZ24gdG8gdGhlXG4gICAqIGBhcmlhLWNvbnRyb2xzYCBhdHRyaWJ1dGUgb2YgdGhlIGxpbmsuXG4gICAqL1xuICBASW5wdXQoKVxuICBhcmlhQ29udHJvbHM6IHN0cmluZztcbiAgLyoqXG4gICAqIEV4cGVjdHMgYSB2YWx1ZSB0byBhc3NpZ24gdG9cbiAgICogdGhlIGBhcmlhLWxhYmVsbGVkYnlgIGF0dHJpYnV0ZSBvZiB0aGUgbGluay5cbiAgICovXG4gIEBJbnB1dCgpXG4gIGFyaWFMYWJlbGxlZGJ5OiBzdHJpbmc7XG4gIC8qKlxuICAgKiBFeHBlY3RzIGEgdmFsdWUgdG8gYXNzaWduIHRvXG4gICAqIHRoZSBgYXJpYS1zZWxlY3RlZGAgYXR0cmlidXRlIG9mIHRoZSBsaW5rLlxuICAgKi9cbiAgQElucHV0KClcbiAgYXJpYVNlbGVjdGVkOiBzdHJpbmc7XG4gIC8qKlxuICAgKiBFeHBlY3RzIGEgdmFsdWUgdG8gYXNzaWduIHRvXG4gICAqIHRoZSBgYXJpYS1oaWRkZW5gIGF0dHJpYnV0ZSBvZiB0aGUgbGluay5cbiAgICovXG4gIEBJbnB1dCgpXG4gIGFyaWFIaWRkZW46IHN0cmluZztcbiAgLyoqXG4gICAqIEV4cGVjdHMgYSB2YWx1ZSB0byBhc3NpZ25cbiAgICogdG8gdGhlIGBhcmlhLWN1cnJlbmB0IGF0dHJpYnV0ZSBvZiB0aGUgbGluay5cbiAgICovXG4gIEBJbnB1dCgpXG4gIGFyaWFDdXJyZW50OiBzdHJpbmc7XG4gIC8qKlxuICAgKiBFeHBlY3RzIGEgdmFsdWUgdG8gYXNzaWduIHRvXG4gICAqIHRoZSBgYXJpYS1leHBhbmRlZCBgYXR0cmlidXRlIG9mIHRoZSBsaW5rLlxuICAgKi9cbiAgQElucHV0KClcbiAgYXJpYUV4cGFuZGVkOiBzdHJpbmc7XG4gIC8qKlxuICAgKiBFeHBlY3RzIGEgdmFsdWUgdG8gYXNzaWduXG4gICAqIHRvIHRoZSBgYXJpYS1oYXNwb3B1cGAgYXR0cmlidXRlIG9mIHRoZSBsaW5rLlxuICAgKi9cbiAgQElucHV0KClcbiAgYXJpYUhhc1BvcFVwOiBzdHJpbmc7XG4gIC8qKlxuICAgKiBFeHBlY3RzIGEgdmFsdWUgdG8gYXNzaWduIHRvXG4gICAqIHRoZSBgYXJpYS1sYWJlbGAgYXR0cmlidXRlIG9mIHRoZSBsaW5rLlxuICAgKi9cbiAgQElucHV0KClcbiAgYXJpYUxhYmVsOiBzdHJpbmc7XG4gIC8qKlxuICAgKiBUaGUgdmFsdWUgc3VwcGxpZWQgd2lsbCBiZSBhc3NpZ25lZCB0byB0aGVcbiAgICogYGRhdGEtYW5hbHl0aWNzYCBhdHRyaWJ1dGUgb24gdGhlIGNvbXBvbmVudC5cbiAgICogSW50ZW5kZWQgZm9yIGFuIG91dHNpZGVcbiAgICogbGlicmFyeSB0byBjYXB0dXJlIGRhdGEuXG4gICAqL1xuICBASW5wdXQoKVxuICBhbmFseXRpY3NTdHJpbmc6IHN0cmluZztcbiAgLyoqXG4gICAqIEV4cGVjdHMgYSB2YWx1ZSB0byBhc3NpZ24gdG9cbiAgICogdGhlIGB0YXJnZXRgIGF0dHJpYnV0ZSBvZiB0aGUgbGluay5cbiAgICovXG4gIEBJbnB1dCgpXG4gIHRhcmdldDogc3RyaW5nO1xuICAvKipcbiAgICogRXhwZWN0cyBhIHNwYWNlIHNlcGFyYXRlZCBzdHJpbmdcbiAgICogb2YgY2xhc3NlcyB0byBiZSBhZGRlZCB0byB0aGVcbiAgICogY29tcG9uZW50LlxuICAgKi9cbiAgQElucHV0KClcbiAgYWRkaXRpb25hbENsYXNzZXM6IHN0cmluZztcbiAgLyoqXG4gICAqIElmIGB0cnVlYCwgd2lsbCBzZXQgZGlzYWJsZWQgc3R5bGVzIG9uIHRoZSBsaW5rLlxuICAgKi9cbiAgQElucHV0KClcbiAgaXNEaXNhYmxlZDogYm9vbGVhbjtcbiAgLyoqXG4gICAqIEJ5IGRlZmF1bHQsIHRoZSBjb21wb25lbnQgZGV0ZXJtaW5lcyBpZlxuICAgKiB0aGUgYGhyZWZgIGlzIGFuIGV4dGVybmFsIG9yIGludGVybmFsIGxpbmtcbiAgICogYnkgbG9va2luZyBmb3IgdGhlIGA6YCBjaGFyYWN0ZXIgaW4gdGhlXG4gICAqIGBocmVmYCBzdHJpbmcuIElmIGV4dGVybmFsIGxpbmsgZnVuY3Rpb25hbGl0eVxuICAgKiBpcyBkZXNpcmVkIHdpdGggYW4gYGhyZWZgIHZhbHVlIHRoYXQgY29udGFpbnNcbiAgICogYSBgOmAgc2V0IHRoaXMgaW5wdXQgdG8gdHJ1ZS4gVGhpcyBvdmVycmlkZXNcbiAgICogdGhlIGRlZmF1bHQgYW5kIGF2b2lkcyB1c2luZyB0aGUgQW5ndWxhciBSb3V0ZXIuXG4gICAqL1xuICBASW5wdXQoKVxuICBpc0V4dGVybmFsID0gZmFsc2U7XG5cbiAgbmdPbkluaXQoKSB7XG5cbiAgICAvLyBUaGlzIG1lc3NhZ2UgaXMgc3BsaXQgdXAgbGlrZSB0aGlzIHNvIHRoYXQgd2UgY2FuIGtlZXAgdGhlIGxpbmVcbiAgICAvLyBsZW5ndGggZG93biBpbiB0aGUgZWRpdG9yIHdoaWxlIGFsc28gbG9nZ2luZyBhIHNpbmdsZSB1bmZvcm1hdHRlZFxuICAgIC8vIGxpbmUgb2YgdGV4dCBpbiB0aGUgY29uc29sZS5cbiAgICBjb25zdCBtZXNzYWdlID0gJ1NwYXJrIERlc2lnbiBTeXN0ZW0gV2FybmluZzogU3BhcmsgTGluayBoYXMgYmVlbiAnICtcbiAgICAncmVmYWN0b3JlZCB0byBiZSBhbiBBbmd1bGFyIERpcmVjdGl2ZS4gVGhlIG9sZCBBbmd1bGFyIENvbXBvbmVudCAnICtcbiAgICAndmVyc2lvbiBoYXMgYmVlbiBkZXByZWNhdGVkLiBUaGlzIHZlcnNpb24gd2lsbCBiZSBwZXJtYW5lbnRseSByZW1vdmVkICcgK1xuICAgICdmcm9tIFNwYXJrIGluIG91ciBTdW1tZXIgMjAyMCByZWxlYXNlLiBUbyB1cGRhdGUgdG8gdGhlIG5ldyB2ZXJzaW9uLCAnICtcbiAgICAncmVwbGFjZSBhbnkgaW5zdGFuY2Ugb2YgdGhlIDxzcHJrLWxpbms+IGNvbXBvbmVudCBpbiB5b3VyIGNvZGViYXNlIHdpdGggJyArXG4gICAgJ3RoZSBuZXcgRGlyZWN0aXZlIHN5bnRheC4nO1xuXG4gICAgY29uc29sZS53YXJuKG1lc3NhZ2UpO1xuXG4gICAgLy8gU2V0cyB0aGUgZGVmYXVsdCBocmVmIGlmIG5vbmUgcHJvdmlkZWRcbiAgICBpZiAodGhpcy5ocmVmID09PSAnJyB8fCB0aGlzLmhyZWYgPT09IG51bGwgfHwgdGhpcy5ocmVmID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRoaXMuaHJlZiA9ICcjJztcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgLy8gQnVpbGQganVtcCBsaW5rJ3MgaHJlZlxuICAgIGlmICh0aGlzLmlzSnVtcExpbmsodGhpcy5ocmVmKSkge1xuICAgICAgdGhpcy5ocmVmID0gYCR7dGhpcy5nZXRQYXRoV2l0aG91dEhhc2godGhpcy5yb3V0ZXIudXJsKX0ke3RoaXMuaHJlZn1gO1xuICAgIH1cbiAgfVxuICAvKipcbiAgICogQGlnbm9yZVxuICAgKi9cbiAgaXNFeHRlcm5hbExpbmsodmFsdWUpOiBib29sZWFuIHtcbiAgICByZXR1cm4gbmV3IFJlZ0V4cCgnXi4qOicsICdpJykudGVzdCh2YWx1ZSk7XG4gIH1cbiAgLyoqXG4gICAqIEBpZ25vcmVcbiAgICovXG4gIGlzSnVtcExpbmtXaXRoUGFnZSh2YWx1ZSk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBuZXcgUmVnRXhwKCdeLiojLisnLCAnaScpLnRlc3QodmFsdWUpO1xuICB9XG4gIC8qKlxuICAgKiBAaWdub3JlXG4gICAqL1xuICBpc0p1bXBMaW5rKHZhbHVlKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIG5ldyBSZWdFeHAoJ14jLisnLCAnaScpLnRlc3QodmFsdWUpO1xuICB9XG4gIC8qKlxuICAgKiBAaWdub3JlXG4gICAqL1xuICBpc05vQWN0aW9uTGluayh2YWx1ZSk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB2YWx1ZSA9PT0gJyMnO1xuICB9XG4gIC8qKlxuICAgKiBAaWdub3JlXG4gICAqL1xuICBnZXRQYXRoV2l0aG91dEhhc2godmFsdWUpOiBzdHJpbmcge1xuICAgIHJldHVybiB2YWx1ZS5zcGxpdCgnIycpWzBdO1xuICB9XG4gIC8qKlxuICAgKiBAaWdub3JlXG4gICAqL1xuICBzY3JvbGxUb0lkKCkge1xuICAgIGNvbnN0IGVsZW1lbnRJRCA9IHRoaXMuaHJlZi5zcGxpdCgnIycpLnBvcCgpO1xuICAgIGNvbnN0IGVsZW1lbnQ6IEhUTUxFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZWxlbWVudElEKTtcbiAgICBpZiAoZWxlbWVudCkge1xuICAgICAgZWxlbWVudC5zY3JvbGxJbnRvVmlldygpO1xuICAgIH1cbiAgfVxuICAvKipcbiAgICogQGlnbm9yZVxuICAgKi9cbiAgaGFuZGxlQ2xpY2soZXZlbnQpOiB2b2lkIHtcbiAgICAvLyBMZXQgYnJvd3NlciBoYW5kbGUgcm91dGUgaWYgZXh0ZXJuYWwgTGlua1xuICAgIGlmICh0aGlzLmlzRXh0ZXJuYWxMaW5rKHRoaXMuaHJlZikgfHwgdGhpcy5pc0V4dGVybmFsKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICAgIC8vIFByZXZlbnQgZGVmYXVsdCBhbmQgcmV0dXJuXG4gICAgaWYgKHRoaXMuaXNOb0FjdGlvbkxpbmsodGhpcy5ocmVmKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH0gZWxzZSBpZiAodGhpcy5pc0p1bXBMaW5rV2l0aFBhZ2UodGhpcy5ocmVmKSkge1xuICAgICAgaWYgKFxuICAgICAgICB0aGlzLmdldFBhdGhXaXRob3V0SGFzaCh0aGlzLmhyZWYpID09PVxuICAgICAgICB0aGlzLmdldFBhdGhXaXRob3V0SGFzaCh0aGlzLnJvdXRlci51cmwpXG4gICAgICApIHtcbiAgICAgICAgdGhpcy5zY3JvbGxUb0lkKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnJvdXRlci5uYXZpZ2F0ZUJ5VXJsKHRoaXMuaHJlZik7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucm91dGVyLm5hdmlnYXRlQnlVcmwodGhpcy5ocmVmKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQGlnbm9yZVxuICAgKi9cbiAgZ2V0Q2xhc3NlcygpOiBzdHJpbmcge1xuICAgIGNvbnN0IGNsYXNzQXJyYXk6IHN0cmluZ1tdID0gW107XG5cbiAgICBzd2l0Y2ggKHRoaXMubGlua1R5cGUpIHtcbiAgICAgIGNhc2UgJ3Vuc3R5bGVkJzpcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdzaW1wbGUnOlxuICAgICAgICBjbGFzc0FycmF5LnB1c2goJ3NwcmstYi1MaW5rIHNwcmstYi1MaW5rLS1zaW1wbGUnKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdwbGFpbic6XG4gICAgICAgIGNsYXNzQXJyYXkucHVzaCgnc3Byay1iLUxpbmsgc3Byay1iLUxpbmstLXBsYWluJyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnaWNvbic6XG4gICAgICAgIGNsYXNzQXJyYXkucHVzaChcbiAgICAgICAgICAnc3Byay1iLUxpbmsgc3Byay1iLUxpbmstLXNpbXBsZSBzcHJrLWItTGluay0taGFzLWljb24nXG4gICAgICAgICk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgY2xhc3NBcnJheS5wdXNoKCdzcHJrLWItTGluaycpO1xuICAgICAgICBicmVhaztcbiAgICB9XG5cbiAgICBpZiAodGhpcy5pc0Rpc2FibGVkKSB7XG4gICAgICBjbGFzc0FycmF5LnB1c2goJ3NwcmstYi1MaW5rLS1kaXNhYmxlZCcpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmFkZGl0aW9uYWxDbGFzc2VzKSB7XG4gICAgICB0aGlzLmFkZGl0aW9uYWxDbGFzc2VzLnNwbGl0KCcgJykuZm9yRWFjaChjbGFzc05hbWUgPT4ge1xuICAgICAgICBjbGFzc0FycmF5LnB1c2goY2xhc3NOYW1lKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBjbGFzc0FycmF5LmpvaW4oJyAnKTtcbiAgfVxufVxuIl19