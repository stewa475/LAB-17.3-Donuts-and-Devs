import { __decorate, __metadata } from "tslib";
import { Component, EventEmitter, HostListener, Input, Output } from '@angular/core';
import * as _ from 'lodash';
let SprkModalComponent = class SprkModalComponent {
    /**
     * @ignore
     */
    constructor() {
        /**
         * The value supplied will be
         * rendered as the text for the confirm button.
         */
        this.confirmText = 'Confirm';
        /**
         * The value supplied will be rendered
         * as the text for the cancel button.
         */
        this.cancelText = 'Cancel';
        /**
         * If `true`, the Modal will be shown.
         * If `false`, the modal will not be shown.
         */
        this.isVisible = false;
        /**
         * When the Modal is closed the hide event is
         * emitted and a callback function can
         * be triggered if supplied.
         */
        this.hide = new EventEmitter();
        /**
         * Available when the Modal type is `choice`.
         * The Modal will emit a confirm click event
         * when the confirmation button is clicked.
         * A callback function can be triggered if
         * supplied.
         */
        this.confirmClick = new EventEmitter();
        /**
         * Available when the Modal type is `choice`.
         * The Modal will emit a cancel click event
         * when the cancel link is clicked.
         * A callback function can be triggered if supplied.
         */
        this.cancelClick = new EventEmitter();
        /**
         * @ignore
         */
        this.componentID = _.uniqueId();
        /**
         * @ignore
         */
        this.heading_id = `modalHeading__${this.componentID}`;
        /**
         * @ignore
         */
        this.content_id = `modalContent__${this.componentID}`;
    }
    /**
     * @ignore
     */
    handleKeyboardEvent(event) {
        if (this.isVisible && event.key === 'Escape') {
            this.closeModal(event);
        }
    }
    /**
     * @ignore
     */
    closeModal(event) {
        if (this.modalType !== 'wait') {
            event.preventDefault();
            this.hide.emit(event);
        }
    }
    /**
     * Emits an event when the confirmation
     * button is clicked.
     */
    emitConfirmClick(event) {
        this.confirmClick.emit(event);
    }
    /**
     * Emits an event when the cancel
     * link is clicked.
     */
    emitCancelClick(event) {
        event.preventDefault();
        this.cancelClick.emit(event);
        this.closeModal(event);
    }
};
__decorate([
    Input(),
    __metadata("design:type", String)
], SprkModalComponent.prototype, "title", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], SprkModalComponent.prototype, "modalType", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object)
], SprkModalComponent.prototype, "confirmText", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object)
], SprkModalComponent.prototype, "cancelText", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], SprkModalComponent.prototype, "confirmAnalyticsString", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], SprkModalComponent.prototype, "cancelAnalyticsString", void 0);
__decorate([
    Input(),
    __metadata("design:type", String)
], SprkModalComponent.prototype, "idString", void 0);
__decorate([
    Input(),
    __metadata("design:type", Object)
], SprkModalComponent.prototype, "isVisible", void 0);
__decorate([
    Output(),
    __metadata("design:type", Object)
], SprkModalComponent.prototype, "hide", void 0);
__decorate([
    Output(),
    __metadata("design:type", Object)
], SprkModalComponent.prototype, "confirmClick", void 0);
__decorate([
    Output(),
    __metadata("design:type", Object)
], SprkModalComponent.prototype, "cancelClick", void 0);
__decorate([
    HostListener('document:keydown', ['$event']),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [KeyboardEvent]),
    __metadata("design:returntype", void 0)
], SprkModalComponent.prototype, "handleKeyboardEvent", null);
SprkModalComponent = __decorate([
    Component({
        selector: 'sprk-modal',
        template: `
    <div
      *ngIf="isVisible"
      [ngClass]="{
        'sprk-c-Modal': true,
        'sprk-c-Modal--wait': modalType === 'wait'
      }"
      role="dialog"
      tabindex="1"
      [attr.aria-labelledby]="heading_id"
      aria-modal="true"
      [attr.aria-describedby]="content_id"
      [attr.data-id]="idString"
    >
      <div class="sprk-o-Stack sprk-o-Stack--large">
        <header class="sprk-o-Stack__item sprk-c-Modal__header">
          <h2
            class="sprk-c-Modal__heading sprk-b-TypeDisplayFour"
            [id]="heading_id"
          >
            {{ title }}
          </h2>

          <button
            *ngIf="modalType != 'wait'"
            class="sprk-c-Modal__icon"
            type="button"
            aria-label="Close Modal"
            (click)="closeModal($event)"
          >
            <sprk-icon
              iconType="close"
              additionalClasses="sprk-c-Icon--stroke-current-color"
            ></sprk-icon>
          </button>
        </header>

        <div
          class="sprk-o-Stack__item sprk-c-Modal__body sprk-o-Stack sprk-o-Stack--medium"
        >
          <div
            *ngIf="modalType == 'wait'"
            class="sprk-o-Stack__item sprk-c-Spinner sprk-c-Spinner--circle sprk-c-Spinner--large sprk-c-Spinner--dark"
          ></div>
          <ng-content></ng-content>
        </div>

        <footer
          *ngIf="modalType === 'choice'"
          class="sprk-o-Stack__item sprk-c-Modal__footer"
        >
          <button
            class="sprk-c-Button sprk-u-mrm"
            [attr.data-analytics]="confirmAnalyticsString"
            (click)="emitConfirmClick($event)"
          >
            {{ confirmText }}
          </button>

          <button
            class="sprk-c-Button sprk-c-Button--tertiary"
            [attr.data-analytics]="cancelAnalyticsString"
            (click)="emitCancelClick($event)"
          >
            {{ cancelText }}
          </button>
        </footer>
      </div>
    </div>

    <div
      *ngIf="isVisible"
      class="sprk-c-ModalMask"
      tabindex="-1"
      (click)="closeModal($event)"
    ></div>
  `
    }),
    __metadata("design:paramtypes", [])
], SprkModalComponent);
export { SprkModalComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3Byay1tb2RhbC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9Ac3BhcmtkZXNpZ25zeXN0ZW0vc3BhcmstYW5ndWxhci8iLCJzb3VyY2VzIjpbImxpYi9jb21wb25lbnRzL3NwcmstbW9kYWwvc3Byay1tb2RhbC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFDTCxTQUFTLEVBQ1QsWUFBWSxFQUNaLFlBQVksRUFDWixLQUFLLEVBQ0wsTUFBTSxFQUNQLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sS0FBSyxDQUFDLE1BQU0sUUFBUSxDQUFDO0FBa0Y1QixJQUFhLGtCQUFrQixHQUEvQixNQUFhLGtCQUFrQjtJQW9HN0I7O09BRUc7SUFDSDtRQTlGQTs7O1dBR0c7UUFFSCxnQkFBVyxHQUFHLFNBQVMsQ0FBQztRQUN4Qjs7O1dBR0c7UUFFSCxlQUFVLEdBQUcsUUFBUSxDQUFDO1FBMkJ0Qjs7O1dBR0c7UUFFSCxjQUFTLEdBQUcsS0FBSyxDQUFDO1FBQ2xCOzs7O1dBSUc7UUFFSCxTQUFJLEdBQUcsSUFBSSxZQUFZLEVBQU8sQ0FBQztRQUMvQjs7Ozs7O1dBTUc7UUFFSCxpQkFBWSxHQUFHLElBQUksWUFBWSxFQUFPLENBQUM7UUFDdkM7Ozs7O1dBS0c7UUFFSCxnQkFBVyxHQUFHLElBQUksWUFBWSxFQUFPLENBQUM7UUFDdEM7O1dBRUc7UUFDSCxnQkFBVyxHQUFHLENBQUMsQ0FBQyxRQUFRLEVBQUUsQ0FBQztRQUMzQjs7V0FFRztRQUNILGVBQVUsR0FBRyxpQkFBaUIsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQ2pEOztXQUVHO1FBQ0gsZUFBVSxHQUFHLGlCQUFpQixJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7SUFlbEMsQ0FBQztJQWJoQjs7T0FFRztJQUVILG1CQUFtQixDQUFDLEtBQW9CO1FBQ3RDLElBQUksSUFBSSxDQUFDLFNBQVMsSUFBSSxLQUFLLENBQUMsR0FBRyxLQUFLLFFBQVEsRUFBRTtZQUM1QyxJQUFJLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQyxDQUFDO1NBQ3hCO0lBQ0gsQ0FBQztJQU9EOztPQUVHO0lBQ0gsVUFBVSxDQUFDLEtBQUs7UUFDZCxJQUFJLElBQUksQ0FBQyxTQUFTLEtBQUssTUFBTSxFQUFFO1lBQzdCLEtBQUssQ0FBQyxjQUFjLEVBQUUsQ0FBQztZQUN2QixJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztTQUN2QjtJQUNILENBQUM7SUFFRDs7O09BR0c7SUFDSCxnQkFBZ0IsQ0FBQyxLQUFLO1FBQ3BCLElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ2hDLENBQUM7SUFFRDs7O09BR0c7SUFDSCxlQUFlLENBQUMsS0FBSztRQUNuQixLQUFLLENBQUMsY0FBYyxFQUFFLENBQUM7UUFDdkIsSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDN0IsSUFBSSxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUN6QixDQUFDO0NBQ0YsQ0FBQTtBQWxJQztJQURDLEtBQUssRUFBRTs7aURBQ007QUFNZDtJQURDLEtBQUssRUFBRTs7cURBQ1U7QUFNbEI7SUFEQyxLQUFLLEVBQUU7O3VEQUNnQjtBQU14QjtJQURDLEtBQUssRUFBRTs7c0RBQ2M7QUFRdEI7SUFEQyxLQUFLLEVBQUU7O2tFQUN1QjtBQVEvQjtJQURDLEtBQUssRUFBRTs7aUVBQ3NCO0FBVTlCO0lBREMsS0FBSyxFQUFFOztvREFDUztBQU1qQjtJQURDLEtBQUssRUFBRTs7cURBQ1U7QUFPbEI7SUFEQyxNQUFNLEVBQUU7O2dEQUNzQjtBQVMvQjtJQURDLE1BQU0sRUFBRTs7d0RBQzhCO0FBUXZDO0lBREMsTUFBTSxFQUFFOzt1REFDNkI7QUFrQnRDO0lBREMsWUFBWSxDQUFDLGtCQUFrQixFQUFFLENBQUMsUUFBUSxDQUFDLENBQUM7O3FDQUNsQixhQUFhOzs2REFJdkM7QUFsR1Usa0JBQWtCO0lBaEY5QixTQUFTLENBQUM7UUFDVCxRQUFRLEVBQUUsWUFBWTtRQUN0QixRQUFRLEVBQUU7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7R0E0RVQ7S0FDRixDQUFDOztHQUNXLGtCQUFrQixDQW9JOUI7U0FwSVksa0JBQWtCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgQ29tcG9uZW50LFxuICBFdmVudEVtaXR0ZXIsXG4gIEhvc3RMaXN0ZW5lcixcbiAgSW5wdXQsXG4gIE91dHB1dFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCAqIGFzIF8gZnJvbSAnbG9kYXNoJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnc3Byay1tb2RhbCcsXG4gIHRlbXBsYXRlOiBgXG4gICAgPGRpdlxuICAgICAgKm5nSWY9XCJpc1Zpc2libGVcIlxuICAgICAgW25nQ2xhc3NdPVwie1xuICAgICAgICAnc3Byay1jLU1vZGFsJzogdHJ1ZSxcbiAgICAgICAgJ3NwcmstYy1Nb2RhbC0td2FpdCc6IG1vZGFsVHlwZSA9PT0gJ3dhaXQnXG4gICAgICB9XCJcbiAgICAgIHJvbGU9XCJkaWFsb2dcIlxuICAgICAgdGFiaW5kZXg9XCIxXCJcbiAgICAgIFthdHRyLmFyaWEtbGFiZWxsZWRieV09XCJoZWFkaW5nX2lkXCJcbiAgICAgIGFyaWEtbW9kYWw9XCJ0cnVlXCJcbiAgICAgIFthdHRyLmFyaWEtZGVzY3JpYmVkYnldPVwiY29udGVudF9pZFwiXG4gICAgICBbYXR0ci5kYXRhLWlkXT1cImlkU3RyaW5nXCJcbiAgICA+XG4gICAgICA8ZGl2IGNsYXNzPVwic3Byay1vLVN0YWNrIHNwcmstby1TdGFjay0tbGFyZ2VcIj5cbiAgICAgICAgPGhlYWRlciBjbGFzcz1cInNwcmstby1TdGFja19faXRlbSBzcHJrLWMtTW9kYWxfX2hlYWRlclwiPlxuICAgICAgICAgIDxoMlxuICAgICAgICAgICAgY2xhc3M9XCJzcHJrLWMtTW9kYWxfX2hlYWRpbmcgc3Byay1iLVR5cGVEaXNwbGF5Rm91clwiXG4gICAgICAgICAgICBbaWRdPVwiaGVhZGluZ19pZFwiXG4gICAgICAgICAgPlxuICAgICAgICAgICAge3sgdGl0bGUgfX1cbiAgICAgICAgICA8L2gyPlxuXG4gICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgKm5nSWY9XCJtb2RhbFR5cGUgIT0gJ3dhaXQnXCJcbiAgICAgICAgICAgIGNsYXNzPVwic3Byay1jLU1vZGFsX19pY29uXCJcbiAgICAgICAgICAgIHR5cGU9XCJidXR0b25cIlxuICAgICAgICAgICAgYXJpYS1sYWJlbD1cIkNsb3NlIE1vZGFsXCJcbiAgICAgICAgICAgIChjbGljayk9XCJjbG9zZU1vZGFsKCRldmVudClcIlxuICAgICAgICAgID5cbiAgICAgICAgICAgIDxzcHJrLWljb25cbiAgICAgICAgICAgICAgaWNvblR5cGU9XCJjbG9zZVwiXG4gICAgICAgICAgICAgIGFkZGl0aW9uYWxDbGFzc2VzPVwic3Byay1jLUljb24tLXN0cm9rZS1jdXJyZW50LWNvbG9yXCJcbiAgICAgICAgICAgID48L3NwcmstaWNvbj5cbiAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgPC9oZWFkZXI+XG5cbiAgICAgICAgPGRpdlxuICAgICAgICAgIGNsYXNzPVwic3Byay1vLVN0YWNrX19pdGVtIHNwcmstYy1Nb2RhbF9fYm9keSBzcHJrLW8tU3RhY2sgc3Byay1vLVN0YWNrLS1tZWRpdW1cIlxuICAgICAgICA+XG4gICAgICAgICAgPGRpdlxuICAgICAgICAgICAgKm5nSWY9XCJtb2RhbFR5cGUgPT0gJ3dhaXQnXCJcbiAgICAgICAgICAgIGNsYXNzPVwic3Byay1vLVN0YWNrX19pdGVtIHNwcmstYy1TcGlubmVyIHNwcmstYy1TcGlubmVyLS1jaXJjbGUgc3Byay1jLVNwaW5uZXItLWxhcmdlIHNwcmstYy1TcGlubmVyLS1kYXJrXCJcbiAgICAgICAgICA+PC9kaXY+XG4gICAgICAgICAgPG5nLWNvbnRlbnQ+PC9uZy1jb250ZW50PlxuICAgICAgICA8L2Rpdj5cblxuICAgICAgICA8Zm9vdGVyXG4gICAgICAgICAgKm5nSWY9XCJtb2RhbFR5cGUgPT09ICdjaG9pY2UnXCJcbiAgICAgICAgICBjbGFzcz1cInNwcmstby1TdGFja19faXRlbSBzcHJrLWMtTW9kYWxfX2Zvb3RlclwiXG4gICAgICAgID5cbiAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICBjbGFzcz1cInNwcmstYy1CdXR0b24gc3Byay11LW1ybVwiXG4gICAgICAgICAgICBbYXR0ci5kYXRhLWFuYWx5dGljc109XCJjb25maXJtQW5hbHl0aWNzU3RyaW5nXCJcbiAgICAgICAgICAgIChjbGljayk9XCJlbWl0Q29uZmlybUNsaWNrKCRldmVudClcIlxuICAgICAgICAgID5cbiAgICAgICAgICAgIHt7IGNvbmZpcm1UZXh0IH19XG4gICAgICAgICAgPC9idXR0b24+XG5cbiAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICBjbGFzcz1cInNwcmstYy1CdXR0b24gc3Byay1jLUJ1dHRvbi0tdGVydGlhcnlcIlxuICAgICAgICAgICAgW2F0dHIuZGF0YS1hbmFseXRpY3NdPVwiY2FuY2VsQW5hbHl0aWNzU3RyaW5nXCJcbiAgICAgICAgICAgIChjbGljayk9XCJlbWl0Q2FuY2VsQ2xpY2soJGV2ZW50KVwiXG4gICAgICAgICAgPlxuICAgICAgICAgICAge3sgY2FuY2VsVGV4dCB9fVxuICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICA8L2Zvb3Rlcj5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuXG4gICAgPGRpdlxuICAgICAgKm5nSWY9XCJpc1Zpc2libGVcIlxuICAgICAgY2xhc3M9XCJzcHJrLWMtTW9kYWxNYXNrXCJcbiAgICAgIHRhYmluZGV4PVwiLTFcIlxuICAgICAgKGNsaWNrKT1cImNsb3NlTW9kYWwoJGV2ZW50KVwiXG4gICAgPjwvZGl2PlxuICBgXG59KVxuZXhwb3J0IGNsYXNzIFNwcmtNb2RhbENvbXBvbmVudCB7XG4gIEBJbnB1dCgpXG4gIHRpdGxlOiBzdHJpbmc7XG4gIC8qKlxuICAgKiBUaGlzIGRldGVybWluZXMgdGhlIHZhcmlhbnQgb2YgdGhlIE1vZGFsLlxuICAgKiBDYW4gYmUgYGNob2ljZWAsIGBpbmZvYCwgb3IgYHdhaXRgLlxuICAgKi9cbiAgQElucHV0KClcbiAgbW9kYWxUeXBlOiBzdHJpbmc7XG4gIC8qKlxuICAgKiBUaGUgdmFsdWUgc3VwcGxpZWQgd2lsbCBiZVxuICAgKiByZW5kZXJlZCBhcyB0aGUgdGV4dCBmb3IgdGhlIGNvbmZpcm0gYnV0dG9uLlxuICAgKi9cbiAgQElucHV0KClcbiAgY29uZmlybVRleHQgPSAnQ29uZmlybSc7XG4gIC8qKlxuICAgKiBUaGUgdmFsdWUgc3VwcGxpZWQgd2lsbCBiZSByZW5kZXJlZFxuICAgKiBhcyB0aGUgdGV4dCBmb3IgdGhlIGNhbmNlbCBidXR0b24uXG4gICAqL1xuICBASW5wdXQoKVxuICBjYW5jZWxUZXh0ID0gJ0NhbmNlbCc7XG4gIC8qKlxuICAgKiBUaGUgdmFsdWUgc3VwcGxpZWQgd2lsbCBiZSBhc3NpZ25lZCB0byB0aGVcbiAgICogYGRhdGEtYW5hbHl0aWNzYCBhdHRyaWJ1dGVcbiAgICogb24gdGhlIGNvbmZpcm0gYnV0dG9uLiBJbnRlbmRlZFxuICAgKiBmb3IgYW4gb3V0c2lkZSBsaWJyYXJ5IHRvIGNhcHR1cmUgZGF0YS5cbiAgICovXG4gIEBJbnB1dCgpXG4gIGNvbmZpcm1BbmFseXRpY3NTdHJpbmc6IHN0cmluZztcbiAgLyoqXG4gICAqIFRoZSB2YWx1ZSBzdXBwbGllZCB3aWxsIGJlIGFzc2lnbmVkIHRvIHRoZVxuICAgKiBgZGF0YS1hbmFseXRpY3NgIGF0dHJpYnV0ZVxuICAgKiBvbiB0aGUgY2FuY2VsIGJ1dHRvbi4gSW50ZW5kZWRcbiAgICogZm9yIGFuIG91dHNpZGUgbGlicmFyeSB0byBjYXB0dXJlIGRhdGEuXG4gICAqL1xuICBASW5wdXQoKVxuICBjYW5jZWxBbmFseXRpY3NTdHJpbmc6IHN0cmluZztcbiAgLyoqXG4gICAqIFRoZSB2YWx1ZSBzdXBwbGllZCB3aWxsIGJlIGFzc2lnbmVkXG4gICAqIHRvIHRoZSBgZGF0YS1pZGAgYXR0cmlidXRlIG9uIHRoZVxuICAgKiBjb21wb25lbnQuIFRoaXMgaXMgaW50ZW5kZWQgdG8gYmVcbiAgICogdXNlZCBhcyBhIHNlbGVjdG9yIGZvciBhdXRvbWF0ZWRcbiAgICogdG9vbHMuIFRoaXMgdmFsdWUgc2hvdWxkIGJlIHVuaXF1ZVxuICAgKiBwZXIgcGFnZS5cbiAgICovXG4gIEBJbnB1dCgpXG4gIGlkU3RyaW5nOiBzdHJpbmc7XG4gIC8qKlxuICAgKiBJZiBgdHJ1ZWAsIHRoZSBNb2RhbCB3aWxsIGJlIHNob3duLlxuICAgKiBJZiBgZmFsc2VgLCB0aGUgbW9kYWwgd2lsbCBub3QgYmUgc2hvd24uXG4gICAqL1xuICBASW5wdXQoKVxuICBpc1Zpc2libGUgPSBmYWxzZTtcbiAgLyoqXG4gICAqIFdoZW4gdGhlIE1vZGFsIGlzIGNsb3NlZCB0aGUgaGlkZSBldmVudCBpc1xuICAgKiBlbWl0dGVkIGFuZCBhIGNhbGxiYWNrIGZ1bmN0aW9uIGNhblxuICAgKiBiZSB0cmlnZ2VyZWQgaWYgc3VwcGxpZWQuXG4gICAqL1xuICBAT3V0cHV0KClcbiAgaGlkZSA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuICAvKipcbiAgICogQXZhaWxhYmxlIHdoZW4gdGhlIE1vZGFsIHR5cGUgaXMgYGNob2ljZWAuXG4gICAqIFRoZSBNb2RhbCB3aWxsIGVtaXQgYSBjb25maXJtIGNsaWNrIGV2ZW50XG4gICAqIHdoZW4gdGhlIGNvbmZpcm1hdGlvbiBidXR0b24gaXMgY2xpY2tlZC5cbiAgICogQSBjYWxsYmFjayBmdW5jdGlvbiBjYW4gYmUgdHJpZ2dlcmVkIGlmXG4gICAqIHN1cHBsaWVkLlxuICAgKi9cbiAgQE91dHB1dCgpXG4gIGNvbmZpcm1DbGljayA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuICAvKipcbiAgICogQXZhaWxhYmxlIHdoZW4gdGhlIE1vZGFsIHR5cGUgaXMgYGNob2ljZWAuXG4gICAqIFRoZSBNb2RhbCB3aWxsIGVtaXQgYSBjYW5jZWwgY2xpY2sgZXZlbnRcbiAgICogd2hlbiB0aGUgY2FuY2VsIGxpbmsgaXMgY2xpY2tlZC5cbiAgICogQSBjYWxsYmFjayBmdW5jdGlvbiBjYW4gYmUgdHJpZ2dlcmVkIGlmIHN1cHBsaWVkLlxuICAgKi9cbiAgQE91dHB1dCgpXG4gIGNhbmNlbENsaWNrID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG4gIC8qKlxuICAgKiBAaWdub3JlXG4gICAqL1xuICBjb21wb25lbnRJRCA9IF8udW5pcXVlSWQoKTtcbiAgLyoqXG4gICAqIEBpZ25vcmVcbiAgICovXG4gIGhlYWRpbmdfaWQgPSBgbW9kYWxIZWFkaW5nX18ke3RoaXMuY29tcG9uZW50SUR9YDtcbiAgLyoqXG4gICAqIEBpZ25vcmVcbiAgICovXG4gIGNvbnRlbnRfaWQgPSBgbW9kYWxDb250ZW50X18ke3RoaXMuY29tcG9uZW50SUR9YDtcblxuICAvKipcbiAgICogQGlnbm9yZVxuICAgKi9cbiAgQEhvc3RMaXN0ZW5lcignZG9jdW1lbnQ6a2V5ZG93bicsIFsnJGV2ZW50J10pXG4gIGhhbmRsZUtleWJvYXJkRXZlbnQoZXZlbnQ6IEtleWJvYXJkRXZlbnQpIHtcbiAgICBpZiAodGhpcy5pc1Zpc2libGUgJiYgZXZlbnQua2V5ID09PSAnRXNjYXBlJykge1xuICAgICAgdGhpcy5jbG9zZU1vZGFsKGV2ZW50KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQGlnbm9yZVxuICAgKi9cbiAgY29uc3RydWN0b3IoKSB7fVxuXG4gIC8qKlxuICAgKiBAaWdub3JlXG4gICAqL1xuICBjbG9zZU1vZGFsKGV2ZW50KTogdm9pZCB7XG4gICAgaWYgKHRoaXMubW9kYWxUeXBlICE9PSAnd2FpdCcpIHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLmhpZGUuZW1pdChldmVudCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEVtaXRzIGFuIGV2ZW50IHdoZW4gdGhlIGNvbmZpcm1hdGlvblxuICAgKiBidXR0b24gaXMgY2xpY2tlZC5cbiAgICovXG4gIGVtaXRDb25maXJtQ2xpY2soZXZlbnQpOiB2b2lkIHtcbiAgICB0aGlzLmNvbmZpcm1DbGljay5lbWl0KGV2ZW50KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBFbWl0cyBhbiBldmVudCB3aGVuIHRoZSBjYW5jZWxcbiAgICogbGluayBpcyBjbGlja2VkLlxuICAgKi9cbiAgZW1pdENhbmNlbENsaWNrKGV2ZW50KTogdm9pZCB7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICB0aGlzLmNhbmNlbENsaWNrLmVtaXQoZXZlbnQpO1xuICAgIHRoaXMuY2xvc2VNb2RhbChldmVudCk7XG4gIH1cbn1cbiJdfQ==